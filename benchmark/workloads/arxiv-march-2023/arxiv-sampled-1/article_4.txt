

Nearest-Neighbor Inter-Intra Contrastive Learning from Unlabeled Videos
    David Fan Deyu Yang Xinyu Li Vimal Bhat Rohith MV Amazon Prime Video 

{fandavi, deyu, xxnl, vimalb, kurohith}@amazon.com






    March 30, 2023
===================================================================================================================================





    We develop the steady-state regularized 13-moment equations in the linear regime for rarefied gas dynamics with general collision models. For small Knudsen numbers, the model is accurate up to the super-Burnett order, and the  resulting system of moment equations is shown to have a symmetric structure. We also propose Onsager boundary conditions for the moment equations that guarantees the stability of the equations. The validity of our model is verified by benchmark examples for the one-dimensional channel flows.






§ INTRODUCTION
 
The modeling and computation of rarefied gas dynamics has been a classical research topic in the history of fluid mechanics. On one hand, significant progress has been made in the development of efficient solvers for the Boltzmann equation <cit.>; On the other hand, many researchers still try to avoid the high computational cost and find extensions of classical fluid models such as Euler equations and Navier-Stokes equations and hope that the new models are capable of describing the motion of moderately rarefied gases. The moment method introduced by Grad <cit.> is one of the important approaches in this direction. While Grad's original method suffers from a number of deficiencies such as loss of hyperbolicity and convergence <cit.>, many new ideas have been proposed in the recent years to improve its robustness and make moment methods more widely applicable <cit.>. In this work, we will study the regularized version of Grad's 13-moment equations, which are originally proposed in <cit.> for Maxwell molecules and extended to general gases in <cit.>. In the literature, this model is called R13 equations for short. The R13 equations for Maxwell molecules have been verified for a variety of problems <cit.>. Recently, attentions have been drawn to the study of Onsager boundary conditions, which guarantees the stability of simulations of boundary value problems <cit.>. Here we will consider the formulation of Onsager boundary conditions for general R13 equations with arbitrary elastic collision models. The linearized Boltzmann equation will be taken as the base model, so that rigorous theory of stabilization can be established for the moment equations.

In the linearized setting, one typical form of the moment equations is as follows:

    𝐀_0 ∂/∂ t + ∑_j=1^3 𝐀_j ∂/∂ x_j = 𝐋,

where 𝐀_0 is symmetric positive semidefinite, and 𝐋 is symmetric negative semidefinite. The matrices 𝐀_j, j=1,2,3 are symmetric. Here we allow 𝐀_0 to have zero eigenvalues so that the form (<ref>) can also cover parabolic equations such as the R13 equations. For problems with unbounded domains or periodic boundary conditions, one can show that

d/dt ∫^T 𝐀_0  d= ∫^T 𝐋  d⩽0,

indicating the L^2 stability. For problems on bounded domains, additional conditions on the boundary conditions are suggested in <cit.> to preserve the L^2 stability. Assume that n = (n_1, n_2, n_3)^T is the outer unit normal vector on the boundary point. The conditions are based on the following structures of the matrices 𝐀_j:

    𝐏 (n_1 𝐀_1 + n_2 𝐀_2 + n_3 𝐀_3) 𝐏^T = [    0 𝐀_oe; 𝐀_eo    0 ],

where 𝐏 is an orthogonal matrix converting the moments  to another set of moments, each of which is either odd or even in the normal direction, and we choose the permutation such that

𝐏 = [  _odd; _even ].

The moments in _odd include quantities that changes sign when the frame of reference changes by flipping the normal vector n, and the moments in _even remain unchanged under this transformation. By the symmetry of 𝐀_j, we have 𝐀_oe = 𝐀_eo^T. The structure (<ref>) comes from the fact that the normal flux of an odd moment is an even moment, and the normal flux of an even moment is an odd moment. With this structure, if 𝐀_oe has full row rank, the L^2 stable boundary conditions have the form

    _odd = 𝐐𝐀_oe (_even - g_ext),

where 𝐐 is a positive semidefinite matrix, g_ext refers to the external source coming from the boundary of the domain.
Such boundary conditions are known as Onsager boundary conditions.
The particular form of boundary conditions that has odd moments on the left-hand side originates from Grad's work <cit.>, which ensures the continuity of boundary conditions with respect to the accommodation coefficient. However, for a specific moment system, choosing _odd to be all the odd moments may result in a rank-deficient 𝐀_oe, so that (<ref>) will provide too many boundary conditions. In this work, we will encounter such a situation during our derivation, requiring us to adjust the selections of _odd and _even to restore the surjective property of 𝐀_oe.
The structure of Onsager boundary conditions is useful not only for time-dependent problems.
For steady-state problems (time derivative removed in (<ref>)), Onsager boundary conditions can provide a symmetric weak form, which helps develop the theory of well-posedness and the finite element methods <cit.>.

For the regularized 13-moment equations for Maxwell molecules, the boundary conditions with this particular structure have been devised in <cit.>. However, the technique to derive the Onsager boundary conditions cannot be directly generalized to the R13 equations for more general molecules. In this work, we will reconsider the derivation of the linearized steady-state R13 equations for general collision models, from which we will show clearly how the structure (<ref>) is built into the derivation of moment equations, and thus the boundary conditions in the form (<ref>) can be naturally obtained. 

In the following section, we will review the moment method for the linear Boltzmann equation and the asymptotic expansions of the moments when the Knudsen number is small. Our main results are presented in Section <ref>, where the explicit forms of the linear R13 equations and the Onsager boundary conditions are provided. The derivation of the R13 equations and boundary conditions are respectively given in Section <ref> and <ref>. In Section <ref>, we verify the accuracy of our model by one-dimensional channel problems. A brief conclusion is given in Section <ref>.





§ REVIEW OF THE MOMENT EQUATIONS AND ASYMPTOTIC PROPERTIES OF MOMENTS

We consider the steady-state linear Boltzmann equation

    ξ_j ∂ f/∂ x_j = 1/ℒ [f]

where f(,) is the distribution function, = (x_1,x_2,x_3) denotes the position and = (ξ_1,ξ_2,ξ_3) stands for the velocity of the gas molecules. We apply Einstein's summation convention throughout this work, meaning that when an index appears twice in the same term, the expression represents the sum of this term with this index running from 1 to 3. For example, in (<ref>), 
    ξ_j  ∂ f/∂ x_j =ξ_1  ∂ f/∂ x_1 + ξ_2  ∂ f/∂ x_2 + ξ_3  ∂ f/∂ x_3.
 For indices whose ranges are not from 1 to 3, the summation symbol will be written explicitly. On the right-hand side of (<ref>), the constant  is the Knudsen number characterizing how rarefied the gas is, and ℒ [f] is the linearized Boltzmann collision operator. Below we will introduce the general moment equations for the linearized Boltzmann equation and the asymptotic expansion of the moments in the case of a small Knudsen number.



 §.§ Series expansion and moment equations

Following <cit.>, we expand the distribution function into an infinite series:

    f(,)= ∑_l=0^+∞∑_m=0^+∞(2l+1)!!/l!w_i_1⋯ i_l^m() ψ^m_i_1 ⋯ i_l().

Here, the basis functions ψ_i_1⋯ i_l^m are defined by

    ψ^m_i_1,⋯,i_l()=1/(2π)^3/2L̅_m^(l+1/2)( ||^2/2)ξ_⟨ i_1⋯ξ_i_l ⟩exp( -||^2/2),

where ξ_⟨ i_1⋯ξ_i_l ⟩ is the trace-free part of the tensor ξ_ i_1⋯ξ_i_l (see <cit.>), and L̅_n^(l+1/2) is the normalized Laguerre polynomial

    L̅_n^(l+1/2)(x) = √(√(π)/2^l+1 n! Γ(n+l+3/2)) x^-(l+1/2)( d/dx - 1 )^n x^n+l+1/2.

In literature, people usually define the Maxwellian
    
     f_M() = 1/(2π)^3/2 exp( -||^2/2 ),
    
so that ψ^m_i_1,⋯,i_l()=L̅_m^(l+1/2)(||^2/2) ξ_⟨ i_1⋯ξ_i_l ⟩ f_M(). Compared with the classical series expansion by Grad <cit.>, the Maxwellian f_M is a global equilibrium state due to our linearized setting. This expansion requires us to assume that the distribution function is defined in the following Hilbert space:

L^2(ℝ^3, [f_M()]^-1  d) := { f |∫_ℝ^3 [f()]^2/f_M()  d< +∞},

so that all the moments of the distribution function can be properly defined. The inner product of this Hilbert space is

   ⟨g_1,g_2⟩:= ∫_ℝ^3 g_1()g_2()/f_M() ,

so that we can express the coefficients w_i_1⋯ i_l^m as the moments of the distribution function:

    w_i_1⋯ i_l^n() = ⟨ f, ψ^m_i_1⋯ i_l⟩.

In particular, we would like to highlight the relationship between these coefficients and the quantities in Grad's 13-moment equations:

    ρ = w^0,    v_i = √(3) w_i^0,   θ = -√(2/3) w^1,   σ_ij = √(15) w_ij^0,    q_i = -√(15/2) w_i^1,

where ρ, v_i, θ, σ_ij and q_i denote the density, velocity, temperature, stress tensor and heat flux, respectively.

Due to the rotational invariance of the collision, the linear operator ℒ satisfies 

    ℒ[ ψ^n_i_1,⋯,i_l] = ∑_m=0^+∞ a_lmnψ^m_i_1,⋯,i_l,

where the coefficient a_lmn satisfies a_lmn = a_lnm for all nonnegative integers l,m and n, and

    a_lmn = ⟨ψ_i_1⋯ i_l^m, ℒψ_i_1⋯ i_l^n ⟩/⟨ψ_i_1⋯ i_l^m, ψ_i_1⋯ i_l^m ⟩.

Note that we have chosen the basis functions such that ⟨ψ_i_1⋯ i_l^n, ψ_i_1⋯ i_l^n ⟩ depends only on i_1, ⋯, i_l, leading to the symmetry of a_lmn.
Due to the conservation of mass, momentum and energy, it holds that

    a_00n = a_0n0 = a_01n = a_0n1 = a_10n = a_1n0 = 0.

For inverse-power-law models, these coefficients have been calculated in <cit.>, where it has also been pointed out that the collision operator ℒ is usually an unbounded operator acting on a subset of L^2(ℝ^3, [f_M()]^-1 d).

The equations of the moments w_i_1⋯ i_l^n can be obtained by taking the inner product of ψ_i_1⋯ i_l^n and both sides of the Boltzmann equation (<ref>). The resulting moment equations are

    T_i_1 ⋯ i_l^n =
       1/∑_n'=0^+∞ a_lnn' w_i_1⋯ i_l^n'

where 

    T_i_1⋯ i_l^n:=    ( √(2(n+l)+3)∂ w_i_1⋯ i_l j^n/∂ x_j - √(2n)∂ w_i_1⋯ i_l j^n-1/∂ x_j)
          +   l/2l+1( √(2(n+l)+1)∂ w_⟨ i_1⋯ i_l-1^n/∂ x_i_l ⟩ - √(2(n+1))∂ w_⟨ i_1⋯ i_l-1^n+1/∂ x_i_l⟩).

The derivation of these equations will be briefly introduced in Section <ref> of the supplementary material.



 §.§ Asymptotic expansion of moments


Assuming that  is a small parameter, we consider the asymptotic expansions of w_i_1⋯ i_l^n:

    w_i_1⋯ i_l^n =  w_i_1⋯ i_l^n|0 +  w_i_1⋯ i_l^n|1 + ^2 w_i_1⋯ i_l^n|2 + ^3 w_i_1⋯ i_l^n|3 + ⋯.

The classical Chapman-Enskog expansion can be applied to express each term using the density, momentum, energy and their derivatives. Here, instead of performing the Chapman-Enskog expansion, we would like to find the orders of magnitude of each moment and the relationship between the terms in each order.
To this aim, we introduce the coefficients b_lnn'^(n_0) to denote the inverses of a_lmn, which satisfy

    ∑_n'=n_0^+∞ a_lnn' b_ln_1 n'^(n_0) = δ_nn_1.

Note that the coefficients b_0nn'^(0), b_0nn'^(1) and b_1nn'^(0) do not exist due to (<ref>).
By asymptotic analysis, we are able to identify the magnitude of each moment w_i_1⋯ i_l^n and find the linear dependency between w_i_1⋯ i_l^n|k for different n's. This method is known as the order of magnitude approach <cit.>.

Below we list the moments by order up to O(^3) and some results of the linear relationship to be used later in this work. The derivation can be found in Section <ref> in the supplementary material.

    
  (O0) O(1) moments:  w^0, w^1, w^0_i.
    
  (O1) O() moments: {w^n_i}_n=1^∞, {w^n_ij}_n=0^∞. The leading order terms of these moments satisfy 

    w_i^n|1    = b_11n^(1)/b_111^(1) w_i^1|1 for  n ⩾ 1, 
    
        w_ij^n|1    = b_20n^(0)/b_200^(0) w_ij^0|1 for  n ⩾ 0,
    
and the second order terms satisfy  

    w_i^n|2    = γ^(1),n_1/γ^(1),2_1 w_i^2|2 for  n ⩾ 2    with γ^(1),n_1 = ∑_n'=2^∞b_1nn'^(2) (√(2n'+5) b_20n'^(0) - √(2n') b_20,n'-1^(0))/b_200^(0),
     
    
     w_ij^n|2    = γ^(1),n_2/γ^(1),1_2 w_ij^1|2 for  n ⩾ 1    with γ^(1),n_2 = 2/5∑_n'=1^∞b_2nn'^(1) (√(2n'+5) b_11n'^(1) - √(2(n'+1)) b_11,n'+1^(1))/b_111^(1).




  (O2) O(^2) moments: {w^n}_n=2^∞, {w^n_ijk}_n=0^∞. Their leading order terms satisfy 

    w^n|2 =    γ^(2),n_0/γ^(2),2_0w^2|2 with γ^(2),n_0 =  ∑_n'=2^+∞b_0nn'^(2) (√(2n'+3) b_11n'^(1) - √(2n') b_11,n'-1^(1))/b_111^(1),  
        w_ijk^n|2 = γ^(2),n_3/γ^(2),0_3 w_ijk^0|2 with γ^(2),n_3 =  3/7∑_n'=0^+∞b_3nn'^(0)/b_200^(0)(√(2n'+7) b_20n'^(0) - √(2(n'+1)) b_20,n'+1^(0)) .


  (O3) O(^3) moments: {w^n_ijkl}_n=0^∞.





  (O4) o(^3) moments: all other w_i_1⋯ i_l^n which are not listed above.

These results show that only the conserved moments are zeroth-order moments, which agrees with the results from the Chapman-Enskog expansion. Although there are infinite first-order moments, the leading-order terms depend only on the stress tensor (w_ij^0) and the heat flux (w_i^1). The purpose of R13 equations is to formulate equations using only these representative moments up to the first order, and “regularization terms” are added to increase its order of accuracy to cover super-Burnett equations. This requires us to express all second-order terms w_i_1⋯ i_l^n|2 using the thirteen moments appearing in the equations, and such a procedure has been done in the literature <cit.>. However, the approach therein does not clearly show how the stable boundary conditions should be derived. Although attempts have been made to study boundary value problems in <cit.>, the boundary conditions do not have the structure (<ref>) as required in <cit.>. In this paper, we will re-derive the regularized 13-moment equations from another point of view, and equip the model with reasonable boundary conditions with the desired structure. Before that, we will first present our final models in the next section for the readers who are not interested in the derivation.
























§ LINEAR R13 EQUATIONS AND ONSAGER BOUNDARY CONDITIONS

In this section, we present the steady-state linear regularized 13-moment equations for general gas molecules, and provide the Onsager boundary conditions satisfying the conditions in <cit.>. The equations and boundary conditions will be presented using the physical variables ρ, v_i, θ, σ_ij, q_i, which are equivalent to the coefficients w^0, w^1, w^0_i, w^1_i, w^0_ij according to (<ref>).



 §.§ Linearized R13 moment equations


In Section <ref>, We have derived the following equation system of the 13 moments including ρ, v_i, θ, σ_ij, q_i:

   
  * Equations of mass conservation, energy conservation and momentum conservation: 
      
    ∂ v_j/∂ x_j    =   0, 
    ∂ v_j/∂ x_j +  ∂ q_j/∂ x_j    = 0,
    ∂ρ/∂ x_i +∂θ/∂ x_i +∂σ_ij/∂ x_j    = 0 .

    
  * Equations of heat flux and stress tensor:
    
    ∂θ/∂ x_i+ β_4 ∂σ_ij/∂ x_j + 2/15c^(1),1_1∂/∂ x_j(β_0 ∂ q_j/∂ x_i + β_2 ∂ q_⟨ i/∂ x_  j⟩)     =2/15(c^(1),1_1)^21/ℒ^(11)_1 q_i,
    ∂ v_⟨ i/∂ x_j ⟩ + β_4 ∂ q_⟨ i/∂ x_j ⟩ +1/15c^(1),0_2∂/∂ x_k( β_1  ∂σ_k⟨ i/∂ x_j⟩ + β_3 ∂σ_⟨ ij/∂ x_k ⟩)     = 1/15(c^(1),0_2)^21/ℒ^(11)_2 σ_ij


where 

    β_0 =  (A_46)^2/c^(1),1_1 ℒ^(22)_0,     β_1  =  (c^(1),1_1 A_57 - c^(2),1_1A_45)^2/c^(1),1_1 c^(1),0_2(c^(1),1_1ℒ^(22)_1 - c^(2),1_1ℒ^(12)_1) ,
    β_2 =  (c^(1),0_2A_48 - c^(2),0_2A_45)^2/c^(1),1_1 c^(1),0_2(c^(1),0_2ℒ^(22)_2 - c^(2),0_2 ℒ^(12)_2) ,   β_3 =  (A_59)^2/c^(1),0_2 ℒ^(22)_3,   β_4 = - √(2) A_45/15c^(1),1_1c^(1),0_2.





























 The expression of the coefficients  c^(p),n_l and A_ij are given in Section <ref> of the supplementary material and ℒ^(mn)_l is formulated as (<ref>). We remark that for Maxwell molecules, β_1 above takes the form 0/0 and is thus not well-defined. In this case, β_1 is set to be 0. One can easily observe the symmetric structure of the system above, where the complicated second-order derivatives in the last two equations are on the diagonal. We have shown that such moment system has the super-Burnett order. 



 §.§ Onsager boundary conditions
 
The R13 equations are equipped with an Onsager-type boundary conditions which read 











    v_n =  0, 
       q_n =  2χ/2-χ[λ_11(θ - θ^W) + λ_12σ_nn + λ_13∂ q_j/∂ x_j + λ_14∂ q_⟨ n/∂ x_n ⟩],
       σ_t_i n =   2χ/2-χ[ λ_21 (v_t_i - v_t_i^W) + λ_22q_t_i + λ_23∂σ_t_i j/∂ x_j + λ_24∂σ_⟨ nn/∂ x_t_i  ⟩],    i =1,2,
       ∂ q_⟨ t_i/∂ x_n ⟩ =  2χ/2-χ[ λ_31 (v_t_i - v_t_i^W) + λ_32q_t_i + λ_33∂σ_t_i j/∂ x_j + λ_34∂σ_⟨ nn/∂ x_t_i ⟩],    i =1,2,
       ( ∂σ_⟨ nn/∂ x_n ⟩ + λ_45∂σ_ n t_j/∂ x_t_j)  
        =   2χ/2-χ[ λ_41(θ - θ^W) + λ_42σ_nn + λ_43∂ q_j/∂ x_j + λ_44∂ q_⟨ n/∂ x_n ⟩], 
       (∂σ_⟨ t_it_i/∂ x_n ⟩ + 1/2∂σ_⟨ nn/∂ x_n ⟩) =   2χ/2-χ(λ_51σ_t_it_i + λ_52σ_nn),   i =1,2,
       ∂σ_⟨ t_1t_2/∂ x_n ⟩ =  2χ/2-χλ_61σ_t_1t_2.

The expressions of coefficient λ_ij can be found in Section <ref> of the supplementary material. 







§ DERIVATION OF R13 EQUATIONS


We will now present the derivation of the R13 equations given in Section <ref>. Our derivation will use a method different from previous papers <cit.>, so that it is clear why the structure (<ref>) exist in the final system.
Since the derivation of moment equations often involves complicated notations and calculations, in order to better explain the main idea of our derivation, we will first write the equations using operators on function spaces instead of the moments (Section <ref>), and then explain how to convert the abstract form to the explicit moment equations (Section <ref>).





 §.§ Reformulation of the distribution function


In Section <ref>, we have seen that when using ψ_i_1 ⋯ i_l^m f_M as basis functions, there are infinite O(^d) coefficients for any d ≥ 1, which is inconvenient for the derivation of moment equations. In this section, we will look for new basis functions such that in the expansions, only finite coefficients have the order O(^k) for any k. In other words, we seek the following orthogonal decomposition of the function space:

L^2(ℝ^3, [f_M()]^-1  d) = 𝕍^(0) ⊕𝕍^(1) ⊕𝕍^(2) ⊕⋯
such that each 𝕍^(k) is a finite dimensional space, and it holds that

    𝒫^(k) f ∼ O(^k),     ∀ k ∈ℕ,

where 𝒫^(k) is the projection operator from L^2(ℝ^3, [f_M()]^-1 d) onto 𝕍^(k). Such a decomposition allows us to consider the projection of f onto a finite dimensional space when we want to achieve a reduced model up to a given order of accuracy.

For the purpose of deriving R13 equations, we just need to use the function spaces from 𝕍^(0) to 𝕍^(3). They will be discussed in the following subsections.



  §.§.§ The zeroth-order function space

The function space 𝕍^(0) can be easily observed from the Chapman-Enskog expansion. It should be spanned by the basis functions corresponding to the conserved moments, which means

    𝕍^(0) = span{ψ^0, ψ^1, ψ_i^0 | i = 1,2,3}.

It is clear that

𝕍^(0) = 5.




  §.§.§ The first-order function space

Our idea to find the first-order function space is to first construct the orthogonal complement of 𝕍^(0)⊕𝕍^(1), and then find 𝕍^(1) by orthogonality. This orthogonal complement will include the part of f that has order higher than or equal to O(^2). According to (O2)-(O4) in Section <ref>, we know that all the following functions should be members of (𝕍^(0)⊕𝕍^(1))^⊥:

    ψ^n  for  n ≥ 2,     ψ_i_1 ⋯ i_l^n  for all  l ≥ 3  and  n ≥ 0.

In addition, the relation (<ref>) yields

    w_i^n - b_11n^(1)/b_111^(1) w_i^1 = ⟨ f,  ψ_i^n - b_11n^(1)/b_111^(1)ψ_i^1⟩∼ O(^2)  for  n ≥ 2,

meaning that

    ψ_i^n - b_11n^(1)/b_111^(1)ψ_i^1∈ (𝕍^(0)⊕𝕍^(1))^⊥,     ∀ i = 1,2,3,    n ≥ 2.

Similarly, we can use (<ref>) to obtain

    ψ_ij^n - b_20n^(0)/b_200^(0)ψ_ij^0∈ (𝕍^(0)⊕𝕍^(1))^⊥,     ∀ i = 1,2,3,    n ≥ 1.

We can now conclude that (𝕍^(0)⊕𝕍^(1))^⊥ is the subspace of L^2(ℝ^3, [f_M()]^-1 d) spanned by all the functions in (<ref>)(<ref>)(<ref>). Consequently, we can find 𝕍^(1) in the form of

    𝕍^(1) = span{ϕ_i^(1), ϕ_ij^(1) |  i,j = 1,2,3 },

where

ϕ_i^(1) = ∑_n=1^+∞ c_1^(1),n ψ_i^n,     ϕ_ij^(1) = ∑_n=0^+∞ c_2^(1),n ψ_ij^n.

The coefficients c_1^(1),n and c_2^(1),n are determined by solving 

    ⟨ψ_i^n - b_11n^(1)/b_111^(1)ψ_i^1,ϕ_i^(1)⟩  =0    and   ⟨ψ_ij^n - b_20n^(0)/b_200^(0)ψ_ij^0 ,ϕ_ij^(1)⟩   =0

respectively, and are then scaled such that

    ∑_n=1^+∞|c_1^(1),n|^2 = ∑_n=0^+∞|c_2^(1),n|^2 = 1.

Since ψ_ij^n is a trace-free tensor, we have

𝕍^(1) = 8.




  §.§.§ The second-order function space

The second-order function spaces can be found in a similar way. Using (O2)–(O4), we notice that the following functions are members of (𝕍^(0)⊕𝕍^(1)⊕𝕍^(2))^⊥:

    ψ^n - γ_n/γ_2ψ^2  for  n ≥ 3,     ( ψ_i^n - b^(1)_11n/b^(1)_111ψ^1_i ) - γ^(1),n_1/γ^(1),2_1( ψ_i^2 - b^(1)_112/b^(1)_111ψ^1_i )  for  n ≥ 3, 
    ( ψ_ij^n - b^(0)_20n/b^(0)_200ψ^0_ij) - γ^(1),n_2/γ^(1),1_2( ψ_ij^1 - b^(0)_201/b^(0)_200ψ^0_ij)  for  n ≥ 2,     ψ_ijk^n - γ^(2),n_3/γ^(2),0_3ψ_ijk^0  for  n ≥ 1, 
    ψ_i_1⋯ i_l^n  for all  l ≥ 4  and  n ≥ 0.

Let (𝕍^(0)⊕𝕍^(1)⊕𝕍^(2))^⊥ be the linear span of all these functions. We can find 𝕍^(2) in the following form:

    𝕍^(2) = span{ϕ^(2), ϕ_i^(2), ϕ_ij^(2), ϕ_ijk^(2) |  i,j,k = 1,2,3
    },

where

    ϕ^(2) = ∑_n=2^+∞ c_0^(2),nψ^n,     ϕ_i^(2) = ∑_n=2^+∞ c_1^(2),n(ψ_i^n - b^(1)_11n/b^(1)_111ψ^1_i), 
    ϕ_ij^(2) = ∑_n=1^+∞ c_2^(2),n(ψ_ij^n - b^(0)_20n/b^(0)_200ψ^0_ij),     ϕ_ijk^(2) = ∑_n=0^+∞ c_3^(2),nψ_ijk^n.

For simplicity, we let

c_1^(2),1 = -∑_n=2^+∞ c_1^(2),n b_11n^(1)/b_111^(1),     c_2^(2),0 = -∑_n=1^+∞ c_2^(2),n b_20n^(0)/b_200^(0),

so that

    ϕ_i^(2) = ∑_n=1^+∞ c_1^(2),nψ_i^n,     ϕ_ij^(2) = ∑_n=0^+∞ c_2^(2),nψ_ij^n.

These coefficients are again determined by the orthogonality similar to (<ref>) and then scaled similarly as (<ref>). The expressions of c^(1),n_l and c^(2),n_l can be found in Section <ref> of the supplementary material. Also, it is not difficult to find that

𝕍^(2) = 16.




  §.§.§ The third-order function space

The space 𝕍^(3) can again be derived using the same strategy. The result will have the form

𝕍^(3) = span {
  ϕ^(3), ϕ_i^(3), ϕ_ij^(3), ϕ_ijk^(3), ϕ_ijkl^(3)  |  i,j,k,l = 1,2,3
},

and

𝕍^(3) = 25.

For our purpose, the precise forms of these functions will not be used.

For Maxwell molecules, due to the special structure b_lnn'^n_0 = 0 for all n ≠ n', the function space 𝕍^(2) will be slightly different. Instead of (<ref>), we will have

𝕍^(2) = span {
  ϕ^(2), ϕ_ij^(2), ϕ_ijk^(2)  |  i,j,k = 1,2,3
},

and thus 𝕍^(2) = 13. In fact, we also have ϕ^(2) = ψ^2, ϕ_ij^(2) = ψ_ij^1 and ϕ_ijk^(2) = ψ_ijk, which can significantly simplify the derivation. In this paper, we will mainly focus on the R13 equations for general molecules. One can find the equations for Maxwell molecules in many references such as <cit.>.




 §.§ The abstract form of regularized 13-moment equations
 
In order to derive R13 moment equations that are accurate up to the super-Burnett order, it suffices to work only in the function space

𝕍 := 𝕍^(0) ⊕𝕍^(1) ⊕𝕍^(2) ⊕𝕍^(3).

In other words, we consider the following approximation of the Boltzmann equation (<ref>):

∂/∂x_j (𝒫_𝕍 ξ_j 𝒫_𝕍 f) = 1/ 𝒫_𝕍 ℒ𝒫_𝕍 f.

Here 𝒫_𝕍 denotes the projection operator from L^2(ℝ^3, [f_M()]^-1 d) onto 𝕍. One can easily verify that both 𝒫_𝕍ξ_j 𝒫_𝕍 and 𝒫_𝕍ℒ𝒫_𝕍 are self-adjoint operators.

To separate different orders in the distribution function f, we further write 𝒫_𝕍 f as

𝒫_𝕍 f = f^(0) + f^(1) + f^(2) + f^(3),

where f^(k) = 𝒫^(k) f (see (<ref>)). Thus, the projected Boltzmann equation can be written in the following form:

    ∑_j=1^3 ∂/∂ x_j(
    [ 𝒜_j^(00) 𝒜_j^(01) 𝒜_j^(02) 𝒜_j^(03); 𝒜_j^(10) 𝒜_j^(11) 𝒜_j^(12) 𝒜_j^(13); 𝒜_j^(20) 𝒜_j^(21) 𝒜_j^(22) 𝒜_j^(23); 𝒜_j^(30) 𝒜_j^(31) 𝒜_j^(32) 𝒜_j^(33) ][ f^(0); f^(1); f^(2); f^(3) ]) = 1/[      0      0      0      0;      0 ℒ^(11) ℒ^(12) ℒ^(13);      0 ℒ^(21) ℒ^(22) ℒ^(23);      0 ℒ^(31) ℒ^(32) ℒ^(33) ][ f^(0); f^(1); f^(2); f^(3) ],

where

𝒜_j^(kl) = 𝒫^(k) ξ_j 𝒫^(l),     ℒ^(kl) = 𝒫^(k) ℒ 𝒫^(l).

Note that the zero operators on the right-hand side of (<ref>) comes from the conservation laws, and on the left-hand side, we have written the sum over j explicitly for clearness. The self-adjointness of 𝒫_𝕍ξ_j 𝒫_𝕍 and 𝒫_𝕍ℒ𝒫_𝕍 implies that 𝒜_j^(kl) = [𝒜_j^(lk)]^† and ℒ_j^(kl) = [ℒ_j^(lk)]^†. For simplicity, below we will use the definition

𝒜^(kl) = ∑_j=1^3 ∂/∂x_j 𝒜_j^(kl),

so that the equations (<ref>) become 

    𝒜f = 1/ℒf,

where

    𝒜 =
    [ 𝒜^(00) 𝒜^(01) 𝒜^(02) 𝒜^(03); 𝒜^(10) 𝒜^(11) 𝒜^(12) 𝒜^(13); 𝒜^(20) 𝒜^(21) 𝒜^(22) 𝒜^(23); 𝒜^(30) 𝒜^(31) 𝒜^(32) 𝒜^(33) ],   ℒ = 
    [      0      0      0      0;      0 ℒ^(11) ℒ^(12) ℒ^(13);      0 ℒ^(21) ℒ^(22) ℒ^(23);      0 ℒ^(31) ℒ^(32) ℒ^(33) ],   f = [ f^(0); f^(1); f^(2); f^(3) ].


In the rest part of this section, we will derive a simplified version of the equations (<ref>) in the following form:

    [  𝒜^(00)  𝒜^(01)  𝒜^(02);  𝒜^(10)  𝒜^(11)  𝒜^(12);  𝒜^(20)  𝒜^(21) 𝒜̅^(22) ][ f^(0); f^(1); f^(2) ]
    = 1/[      0      0      0;      0 ℒ^(11) ℒ^(12);      0 ℒ^(21) ℒ^(22);        ][ f^(0); f^(1); f^(2) ].

We require that the super-Burnett equations can also be derived from these equations. The abstract system (<ref>) will be further formulated as R13 equations in Section <ref>. To specify the operator 𝒜̅^(22) and clarify why the final equations hold the form (<ref>), we need three steps given in the three subsections below.



  §.§.§ Step 1: Diagonalization of the right-hand side

The first step of our derivation is to reformulate (<ref>) into an equivalent form where the right-hand side contains only a diagonal matrix of operators. Such a form will make it easier for us to spot high-order terms that can be dropped in the final form of R13 equations. To this end, we define

    𝒬 = 
    [       ℐ       0       0       0;       0       ℐ       0       0;       0       0       ℐ       0;       0       0 -ℬ^(32)       ℐ ][       ℐ       0       0       0;       0       ℐ       0       0;       0 -ℬ^(21)       ℐ       0;       0 -ℬ^(31)       0       ℐ ],

where

    ℬ^(21) = ℒ^(21) [ℒ^(11)]^-1,     ℬ^(31) = ℒ^(31) [ℒ^(11)]^-1, 
    ℬ^(32) =[ℒ^(32) - ℬ^(31)ℒ^(12)][ℒ^(22) - ℬ^(21)ℒ^(12)]^-1.

This procedure is similar to Gaussian elimination of ℒ, and the invertibility of the operators in the definitions of ℬ^(kl) can be guaranteed by the fact that the linearized Boltzmann collision operator ℒ is negative semidefinite with its nullspace being 𝕍^(0). Let 𝒬^† be the adjoint transpose of the operator matrix 𝒬. It can be seen that the matrix 𝒬ℒ𝒬^† is diagonal.

We now apply this transformation to the projected Boltzmann equation (<ref>). By introducing f̃ = 𝒬^-†f, we can multiply both sides of (<ref>) by 𝒬 and write the result as

    𝒬𝒜𝒬^†f̃ = 1/𝒬ℒ𝒬^†f̃.

We claim that the operator matrices 𝒬𝒜𝒬^† and 𝒬ℒ𝒬^† have the following structures:

    𝒬𝒜𝒬^† =[  𝒜^(00)  𝒜^(01)       0       0;  𝒜^(10)  𝒜^(11) 𝒜̃^(12)       0;       0 𝒜̃^(21) 𝒜̃^(22) 𝒜̃^(23);       0       0 𝒜̃^(32) 𝒜̃^(33) ],     𝒬ℒ𝒬^† =[       0       0       0       0;       0  ℒ^(11)       0       0;       0       0 ℒ̃^(22)       0;       0       0       0 ℒ̃^(33) ].

The diagonal structure of 𝒬ℒ𝒬^† has been clarified in the construction of the matrix 𝒬. To explain why 𝒬𝒜𝒬^† is tridiagonal, we need the following facts:


  * By straightforward calculation, we have

f̃ := [ f̃^(0); f̃^(1); f̃^(2); f̃^(3) ]
= [                                                       f^(0); f^(1) + [ℬ^(21)]^† f^(2) + [ℬ^(31) + ℬ^(32) ℬ^(21)]^† f^(3);                                    f^(2) + [ℬ^(32)]^† f^(3);                                                       f^(3) ],

which shows that the last two components of 𝒬ℒ𝒬^†f̃ have magnitudes O(^2) and O(^3), respectively.

  * By (<ref>), the last two components of 𝒬𝒜𝒬^†f̃ should have magnitudes O() and O(^2), respectively. Therefore, the three operators below the subdiagonal of 𝒬𝒜𝒬^† can only be zero operators.

  * Due to the symmetric structure of 𝒬𝒜𝒬^†, the three operators above its superdiagonal must also be zero operators.




  §.§.§ Step 2: Dropping high-order terms

In this step, our purpose is to drop as many terms in (<ref>) as possible while retaining the super-Burnett order of these equations. One possible approach to obtain super-Burnett equations is to perform the following Maxwell iteration based on (<ref>):

    f̃_k+1^(1)   =  [ℒ^(11)]^-1( 𝒜^(10) f^(0) + 𝒜^(11)f̃_k^(1) + 𝒜̃^(12)f̃_k^(2)),    f̃^(1)_0    = 0, 
    f̃_k+1^(2)   =  [ℒ̃^(22)]^-1( 𝒜̃^(21) f_k^(1) + 𝒜̃^(22)f̃_k^(2) + 𝒜̃^(23)f̃_k^(3)),    f̃^(2)_0    = 0, 
    f̃_k+1^(3)   =  [ℒ̃^(33)]^-1( 𝒜̃^(32)f̃_k^(2) + 𝒜̃^(33)f̃_k^(3)),    f̃^(3)_0    = 0.

Note that the local equilibrium f^(0) does not attend the iteration. The super-Burnett equations can be written as

𝒜^(00) f^(0) + 𝒜^(01) f̃^(1)_3 = 0,

where f̃^(1)_3 is from the result of three Maxwell iterations. Straightforward calculation yields 


f̃^(1)_3
   =[ℒ^(11)]^-1 𝒜^(10) f^(0) + ^2 [ℒ^(11)]^-1 𝒜^(11) [ℒ^(11)]^-1 𝒜^(10) f^(0) 

       + ^3  ([ℒ^(11)]^-1  𝒜^(11))^2 [ℒ^(11)]^-1 𝒜^(10) f^(0) 

       + ^3 [ℒ^(11)]^-1 𝒜̃^(12) [ℒ^(22)]^-1 𝒜̃^(21) 
 [ℒ^(11)]^-1 𝒜^(10) f^(0).


which has nothing to do with the operators 𝒜̃^(22), 𝒜̃^(23), 𝒜̃^(32) and 𝒜̃^(33). Therefore, we can set these four operators in (<ref>) to be zero and claim that the resulting equations

    [  𝒜^(00)  𝒜^(01)       0       0;  𝒜^(10)  𝒜^(11) 𝒜̃^(12)       0;       0 𝒜̃^(21)       0       0;       0       0       0       0 ][  f^(0); f̃^(1); f̃^(2);  f^(3) ] = 1/[       0       0       0       0;       0  ℒ^(11)       0       0;       0       0 ℒ̃^(22)       0;       0       0       0 ℒ̃^(33) ][  f^(0); f̃^(1); f̃^(2);  f^(3) ]

still have the super-Burnett order.






  §.§.§ Step 3: Applying the inverse transformation
 The equations (<ref>) already give us the abstract form of the R13 equations. However, due to the transformation introduced by 𝒬, the left-hand sides of these equations no longer represent the approximation of ξ_j ∂_x_jf, and the right-hand sides no longer represent the approximation of ℒf. Recovering such straightforward correspondence requires applying the inverse transformation 𝒬^-1. By multiplying both sides of (<ref>) by 𝒬^-1 and using f̃ = 𝒬^-†f, we obtain

[  𝒜^(00)  𝒜^(01)  𝒜^(02)  𝒜^(03);  𝒜^(10)  𝒜^(11)  𝒜^(12)  𝒜^(13);  𝒜^(20)  𝒜^(21) 𝒜̅^(22) 𝒜̅^(23);  𝒜^(30)  𝒜^(31) 𝒜̅^(32) 𝒜̅^(33) ]
[ f^(0); f^(1); f^(2); f^(3) ]
= 1/ [      0      0      0      0;      0 ℒ^(11) ℒ^(12) ℒ^(13);      0 ℒ^(21) ℒ^(22) ℒ^(23);      0 ℒ^(31) ℒ^(32) ℒ^(33) ]
[ f^(0); f^(1); f^(2); f^(3) ],

where 

    𝒜̅^(22) = ℬ^(21)𝒜^(12) + 𝒜^(21) [ℬ^(21)]^† - ℬ^(21)𝒜^(11)[ℬ^(21)]^†,

and the operators 𝒜̅^(23), 𝒜̅^(32) and 𝒜̅^(33) are unimportant since (<ref>) already shows f^(3) = 0. We can actually remove f^(3) completely from the system to get the final form (<ref>).

Since f^(3) is no longer present in the final equations, they can be reformulated using a smaller function space

    𝕍 := 𝕍^(0)⊕𝕍^(1)⊕𝕍^(2).

Let 𝒫_𝕍 be the projection operator onto 𝕍. The equations can then be written as

∂/∂x_j (𝒜̅_j f̅) = 1/ 𝒫_𝕍 ℒ f̅,

where f̅ is the unknown function in 𝕍, and

    𝒜̅_j = 𝒫_𝕍ξ_j - (𝒜_j^(22) - ℬ^(21)𝒜_j^(12) - 𝒜_j^(21) [ℬ^(21)]^† + ℬ^(21)𝒜_j^(11)[ℬ^(21)]^†) 𝒫^(2),

which is an operator on 𝕍 approximating the multiplication of a function by the velocity component ξ_j.
It is straightforward to verify that 𝒜̅_j is a self-adjoint operator on 𝕍.

So far, we have obtained a linear system with desired symmetric structure, allowing us to further derive stable boundary conditions. This will be discussed in Section <ref>. In what follows, we will first provide the explicit forms of these equations.














 §.§ Derivation of R13 moment equations


We will now derive the R13 equations presented in Section <ref>.
According to definitions of the function spaces 𝕍^(0), 𝕍^(1) and 𝕍^(2) (see (<ref>)(<ref>)(<ref>)), we can express the projection f̅ := 𝒫_𝕍 f explicitly as

    f̅ = w^0 ψ^0 + w^1 ψ^1 + 3w_i^0 ψ_i^0_zeroth order + 3u_i^(1)ϕ_i^(1) + 15/2 u_ij^(1)ϕ_ij^(1)_first order + u^(2)ϕ^(2) + 3u_i^(2)ϕ_i^(2) + 15/2u_ij^(2)ϕ_ij^(2) + 35/2u_ijk^(2)ϕ_ijk^(2)_second order.

For any f̅∈𝕍 with the above expression, we have

    w^0 = ⟨f̅ , ψ^(0)⟩,      w^1 = ⟨f̅,ψ^(1)⟩,      w_i^0 = ⟨f̅ , ψ_i^(0)⟩, 
    
    u_i^(1) =  ⟨f̅ , ϕ^(1)_i⟩   ,      u_ij^(1) =  ⟨f̅ , ϕ^(1)_ij⟩  , 
    
    u^(2) =   ⟨f̅ , ϕ^(2)⟩  ,      u^(2)_i =  ⟨f̅ , ϕ^(2)_i⟩,      u^(2)_ij =  ⟨f̅ , ϕ^(2)_ij⟩ ,       u^(2)_ijk = ⟨f̅ , ϕ^(2)_ijk⟩.

Our purpose is to find the expressions of ∂_x_j (𝒜̅_j f̅) and 𝒫_𝕍ℒf̅ under such representation.

We begin with the collision term 𝒫_𝕍ℒf̅. Due to the conservation laws, the zeroth-order part of f̅ vanishes after applying ℒ. Using the rotational invariance of ℒ, we get

    𝒫_𝕍ℒf̅ = ℒ_0^(22) u^(2)ϕ^(2) + ∑_m=1^2 ∑_n=1^2 ℒ_1^(mn) u_i^(n)ϕ_i^(m) + ∑_m=1^2 ∑_n=1^2 ℒ_2^(mn) u_ij^(n)ϕ_ij^(m) + ℒ_3^(22) u_ijk^(2)ϕ_ijk^(2),

where 

    ℒ_l^(mn) = (2l+1)!!/l!⟨ϕ_i_1⋯ i_l^(m), ℒϕ_i_1⋯ i_l^(n)⟩/⟨ϕ_i_1⋯ i_l^(m), ϕ_i_1⋯ i_l^(m)⟩
    
    
     =(2l+1)!!/l!∑_m',n' c^(m),m'_l c^(n),n'_l a_ln'm'

This value is independent of the choice of i_1, ⋯, i_l due to the rotational invariance, and is symmetric with respect to the superscript (mn). The expansion (<ref>) can be formally expressed by 

    ϕ^T 
    [ [         0         0         0         0         0         0         0         0         0;         0         0         0         0         0         0         0         0         0;         0         0         0         0         0         0         0         0         0; 0pt15pt
    0         0         0  ℒ_1^(11)         0         0  ℒ_1^(12)         0         0;         0         0         0         0  ℒ_2^(11)         0         0  ℒ_2^(12)         0; 0pt15pt
    0         0         0         0         0  ℒ_0^(22)         0         0         0;         0         0         0  ℒ_1^(21)         0         0  ℒ_1^(22)         0         0;         0         0         0         0  ℒ_2^(21)         0         0  ℒ_2^(22)         0;         0         0         0         0         0         0         0         0  ℒ_3^(22) ]]
    u

where 

    
ϕ^T =       
( ψ^0 ψ^1 ψ^0_i    ϕ^(1)_i ϕ^(1)_ij     ϕ^(2)  ϕ^(2)_i ϕ^(2)_ij ϕ^(2)_ijk ), 
 
u^T =       
( w^0 w^1 w^0_i    u^(1)_i u^(1)_ij     u^(2)  u^(2)_i u^(2)_ij  u^(2)_ijk ),
 



The left-hand side ∂_x_j (𝒜̅_j f̅) should be calculated according to (<ref>). We can first find ∂_x_j(𝒫_𝕍ξ_j f̅) by straightforward calculation using (<ref>). We will again denote the result formally using the form (<ref>)

    ϕ^T.8![ [                         0                         0               √(3)∂/∂ x_i                         0                         0                         0                         0                         0                         0;                         0                         0              -√(2)∂/∂ x_i      √(5)c_1^(1),1∂/∂ x_i                         0                         0      √(5)c^(2),1_1∂/∂ x_i                         0                         0;               √(3)∂/∂ x_i              -√(2)∂/∂ x_i                         0                         0     3√(5)c_2^(1),0∂/∂ x_j                         0                         0    3√(5)c^(2),0_2 ∂/∂ x_j                         0;              0pt15pt
       0     √(5) c_1^(1),1∂/∂ x_i                         0                         0               A_45∂/∂ x_j               A_46∂/∂ x_i                         0               A_48∂/∂ x_j                         0;                         0                         0 3√(5) c_2^(1),0∂_⟨/∂ x_j⟩            A_45∂_⟨/∂ x_j⟩                         0                         0            A_57∂_⟨/∂ x_j⟩                         0               A_59∂/∂ x_k;            0pt15pt
         0                         0                         0               A_46∂/∂ x_i                         0                         0               A_67∂/∂ x_i                         0                         0;                         0      √(5)c^(2),1_1∂/∂ x_i                         0                         0               A_57∂/∂ x_j               A_67∂/∂ x_i                         0               A_78∂/∂ x_j                         0;                         0                         0 3√(5)c^(2),0_2 ∂_⟨/∂ x_j⟩            A_48∂_⟨/∂ x_j⟩                         0                         0            A_78∂_⟨/∂ x_j⟩                         0               A_89∂/∂ x_k;                         0                         0                         0                         0            A_59∂_⟨/∂ x_k⟩                         0                         0            A_89∂_⟨/∂ x_k⟩                         0;                           ]]u

for conciseness, where the expressions of A_ij can be found in Section <ref>. The derivative operator ∂_⟨/∂ x_j ⟩ in the above matrix is defined such that ∂_⟨/∂ x_j ⟩ u^(d)_i_1⋯ i_l = ∂ u^(d)_⟨ i_1⋯ i_l/∂ x_j⟩ where Einstein's summation should be applied when any of i_1,⋯,i_l is j. 

To get the final form of the R13 equations, we replace the lower-right block of the matrix on the left-hand side by an operator corresponding to 𝒜̅^(22) defined in (<ref>). According to (<ref>), the operator ℬ^(21) = ℒ^(21) [ℒ^(11)]^-1 can be represented by the matrix 

ℬ^(21) := [        0        0; ℒ_1^(21)        0;        0 ℒ_2^(21);        0        0 ]
[ ℒ_1^(11)        0;        0 ℒ_2^(11) ]^-1 =
[                   0                   0; ℒ_1^(21) / ℒ_1^(11)                   0;                   0 ℒ_2^(21) / ℒ_2^(11);                   0                   0 ].

Note that we actually have

    ℒ_1^(21) / ℒ_1^(11) = c_1^(2),1 / c_1^(1),1,   and  ℒ_2^(21) / ℒ_2^(11) = c_2^(2),0 / c_2^(1),0

since 𝒜^(20) - ℬ^(21)𝒜^(10) = 0 (see (<ref>)).
Thus, following (<ref>), the operator 𝒜̅^(22) can be represented by


    ℬ^(21) 
[[    A_46∂/∂x_i             0    A_48∂/∂x_j             0;             0 A_57∂_⟨/∂x_j⟩             0    A_59∂/∂x_k ] ] +
[ [    A_46∂/∂x_i             0;             0    A_57∂/∂x_j; A_48∂_⟨/∂x_j⟩             0;             0 A_59∂_⟨/∂x_k⟩ ] ]  [ℬ^(21)]^T
- ℬ^(21) 
[[              0    A_45 ∂/∂x_j; A_45 ∂_⟨/∂x_j⟩              0 ] ] 
[ℬ^(21)]^T 

=     [                                     0      c^(2),1_1/c^(1),1_1 A_46  ∂/∂x_i                                     0                                     0;      c^(2),1_1/c^(1),1_1 A_46  ∂/∂x_i                                     0                           A̅_78∂/∂x_j                                     0;                                     0                      A̅_78∂_⟨ /∂x_j ⟩                                     0      c^(2),0_2/c^(1),0_2 A_59  ∂/∂x_k;                                     0                                     0 c^(2),0_2/c^(1),0_2 A_59  ∂_⟨ /∂x_k ⟩                                     0 ]


where 

    A̅_78 =  c^(2),1_1/c^(1),1_1 A_48+ c^(2),0_2/c^(1),0_2 A_57- c^(2),1_1 c^(2),0_2/c^(1),1_1 c^(1),0_2 A_45.

The final form of ∂_x_j(𝒜̅_j f̅) can be obtained by using the matrix above to replace the lower-right block of the matrix in (<ref>). The result will then be equated to (<ref>) to get the explicit expressions of the R13 equations, which are given as follows: 
 
    √(3)∂ w^0_j/∂ x_j    = 0,  
    
         -√(2)∂ w^0_j/∂ x_j  + √(5)c_1^(1),1∂ u^(1)_j/∂ x_j +   √(5)c^(2),1_1 ∂ u^(2)_j/∂ x_j    = 0 ,
    √(3)∂ w^0/∂ x_i - √(2)∂ w^1/∂ x_i + 3√(5) c_2^(1),0∂ u^(1)_ij/∂ x_j  + 3√(5)  c^(2),0_2 ∂ u^(2)_ij/∂ x_j    = 0, 
    √(5)c_1^(1),1∂ w^1/∂ x_i + A_45∂ u^(1)_ij/∂ x_j + A_46∂ u^(2)/∂ x_i + A_48∂ u^(2)_ij/∂ x_j    = 1/(ℒ^(11)_1 u^(1)_i+ℒ^(12)_1 u^(2)_i),
    
          3√(5) c_2^(1),0∂ w^0_⟨ i/∂ x_j ⟩ + A_45∂ u^(1)_⟨ i/∂ x_j ⟩ + A_57∂ u^(2)_⟨ i/∂ x_j ⟩ + A_59∂ u^(2)_ijk/∂ x_k    = 1/(ℒ^(11)_2 u^(1)_ij+ℒ^(12)_2 u^(2)_ij),
    
          A_46∂ u^(1)_j/∂ x_j  + c^(2),1_1/c^(1),1_1 A_46∂ u^(2)_j/∂ x_j    =  1/ℒ^(22)_0 u^(2),
    √(5) c^(2),1_1 ∂ w^1/∂ x_i + A_57∂ u^(1)_ij/∂ x_j + c^(2),1_1/c^(1),1_1 A_46∂ u^(2)/∂ x_i + A̅_78∂ u^(2)_ij/∂ x_j    = 1/(ℒ^(21)_1 u^(1)_i+ℒ^(22)_1 u^(2)_i),
    
            3√(5) c^(2),0_2 ∂ w^0_⟨ i/∂ x_j ⟩ + A_48∂ u^(1)_⟨ i/∂ x_j ⟩ + A̅_78∂ u^(2)_⟨ i/∂ x_j ⟩ + c^(2),0_2/c^(1),0_2 A_59∂ u^(2)_ijk/∂ x_k    = 1/(ℒ^(21)_2 u^(1)_ij+ℒ^(22)_2 u^(2)_ij),
    
           A_59∂ u^(1)_⟨ ij/∂ x_k ⟩ +  c^(2),0_2/c^(1),0_2 A_59∂ u^(2)_⟨ ij/∂ x_k ⟩    = 1/ℒ^(22)_3 u^(2)_ijk.


It may be more interesting to write down these equations using the variables w_ij^0 and w_i^1. For the distribution function (<ref>), the moments w_ij^0 can be related to the coefficients by

    w_ij^0 = ⟨ψ_ij^0, f̅⟩ = u_i'j'^(1)⟨ψ_ij^0, ϕ_i'j'^(1)⟩ + u_i'j'^(2)⟨ψ_ij^0, ϕ_i'j'^(2)⟩ = c_2^(1),0 u_ij^(1) + c_2^(2),0 u_ij^(2) .

Similarly, we have

    w_i^1 = c_1^(1),1 u_i^(1) + c_1^(2),1 u_i^(2).

Using these variables, equations (<ref>) and (<ref>) become much neater: 

    u^(2) = β'_0 ∂ w^1_j/∂ x_j,      u^(2)_ijk = β'_3 ∂ w^0_⟨ ij/∂ x_k ⟩

where 

   β_0' = A_46/c^(1),1_1ℒ_0^(22),     β_3' =   A_59/c^(1),0_2ℒ_3^(22).

The other two second-order variables u_i^(2) and u_ij^(2) can also be represented using derivatives of w_ij^0 or w_i^1. To get u_i^(2), we need to multiply (<ref>) by c_1^(2),1/c_1^(1),1 and subtract the result by (<ref>). During the calculation, we need to use (<ref>) and (<ref>) to get

    u^(2)_i = β'_1 ∂ w^0_ij/∂ x_j,     β_1'  = c^(1),1_1 A_57 - c^(2),1_1A_45/c^(1),0_2(c^(1),1_1ℒ_1^(22) - c^(2),1_1ℒ_1^(12)).

Similarly, we can use (<ref>) and (<ref>) to find

    u^(2)_ij = β'_2 ∂ w^1_⟨ i/∂ x_j ⟩,     β_2' = c^(1),0_2 A_48 - c^(2),0_2A_45/c^(1),1_1(c^(1),0_2ℒ_2^(22) - c^(2),0_2 ℒ_2^(12)).

Finally, we can plug (<ref>)–(<ref>) into (<ref>)–(<ref>) to get a linear system written completely in the variables w^0, w^1, w_i^0, w_i^1, w_ij^0. The linear system in Section <ref> can then be obtained by applying the relationship (<ref>).

For Maxwell molecules, due to the lack of three dimensions in 𝕍^(2), the variables  u^(2)_i do not exist. As a result, one needs to remove (<ref>) from the system. Also, the expression of β'_1 in (<ref>) becomes 0/0 for Maxwell molecules, and we need to set β'_1 to be zero to obtain correct equations.




























 











§ DERIVATION OF ONSAGER BOUNDARY CONDITIONS FOR R13 EQUATIONS


We are now ready to derive wall boundary conditions for the R13 equations. In this work, we will focus on Maxwell's accommodation model <cit.>, which considers the interaction between gas molecules and the solid wall as a combination of specular reflection and diffusive reflection. In the derivation of boundary conditions for R13 equations, we will again write an abstract form using operators on function spaces to avoid lengthy formulas, and then convert it to its concrete form. Before starting our derivation, we will first briefly review Maxwell's boundary conditions for the linearized Boltzmann equation.



 §.§ Maxwell's boundary condition

Consider the boundary point at which the outer normal unit vector is n = (n_1, n_2, n_3)^T. For simplicity, we adopt the coordinate system with basis vectors n, t_1 and t_2 with t_1 and t_2 being two orthogonal tangent vectors. Thus, the distribution function can now be presented by f(ξ_n, ξ_t_1, ξ_t_2), where ξ_n = ·n and ξ_t_1 and ξ_t_2 are similarly defined. For all other vectors and tensors, the indices will also be changed from 1,2,3 to n,t_1,t_2 in this section. Thus, the Boltzmann equation can be written as 

ξ_n ∂f/∂x_n +
ξ_t_1 ∂f/∂x_t_1 +
ξ_t_2 ∂f/∂x_t_2 = 1/ℒf.


For hyperbolic equations, boundary conditions are needed only for incoming characteristics. Maxwell <cit.> proposed the following wall boundary condition for the distribution function:

    f(ξ_n, ξ_t_1, ξ_t_2) = χ f_W(ξ_n, ξ_t_1, ξ_t_2) + (1-χ) f(-ξ_n, ξ_t_1, ξ_t_2),     ξ_n < 0,

and χ∈ [0,1] is the accommodation coefficient denoting the proportion of the diffusive reflection. Assume that the solid wall has temperature θ^W and only moves in the tangential direction with velocity (0, v_t_1^W, v_t_2^W). Then the “wall Maxwellian” f_W() has the expression 

   f_W(ξ_n, ξ_t_1, ξ_t_2) = w^0,W ψ^0 + w^1,W ψ^1 + 3w_t_1^0,W ψ^0_t_1 + 3w_t_2^0,W ψ^0_t_2.

Here w^1,W = -√(3/2)θ^W, w^0,W_t_i = √(3)/3 v^W_t_i, and w^0,W are chosen such that

    ∫_ℝ^3ξ_n f(ξ_n, ξ_t_1, ξ_t_2)  dξ_n  dξ_t_1 dξ_t_2 = 0,

meaning that the normal mass flow is zero on the solid wall.

To derive boundary conditions for moment equations, it is more convenient to rewrite the (<ref>) in the following equivalent form:

    f_odd(ξ_n, ξ_t_1, ξ_t_2) = χ/2-χ [f_W(ξ_n, ξ_t_1, ξ_t_2) - f_even(ξ_n, ξ_t_1, ξ_t_2)],     ξ_n < 0,

where f_odd and f_even refer to the odd and even parts of f:

    f_odd(ξ_n, ξ_t_1, ξ_t_2)    = f(ξ_n, ξ_t_1, ξ_t_2) - f(-ξ_n, ξ_t_1, ξ_t_2)/2, 
    
    f_even(ξ_n, ξ_t_1, ξ_t_2)    = f(ξ_n, ξ_t_1, ξ_t_2) + f(-ξ_n, ξ_t_1, ξ_t_2)/2.

Alternatively, we can define f_odd and f_even by introducing the odd and even function spaces:

    L_odd^2(ℝ^3, [f_M()]^-1 d)    = {f ∈ L^2(ℝ^3, [f_M()]^-1 d) | f(-ξ_n, ξ_t_1, ξ_t_2) = -f(ξ_n, ξ_t_1, ξ_t_2) }, 
    
    L_even^2(ℝ^3, [f_M()]^-1 d)    = {f ∈ L^2(ℝ^3, [f_M()]^-1 d) | f(-ξ_n, ξ_t_1, ξ_t_2) = f(ξ_n, ξ_t_1, ξ_t_2) },

and let

f_odd = 𝒫_odd f,     f_even = 𝒫_even f.

Here 𝒫_odd and 𝒫_even are projection operators onto the function spaces L_odd^2(ℝ^3, [f_M()]^-1 d) and L_even^2(ℝ^3, [f_M()]^-1 d), respectively. Thus, a more compact way to write down Maxwell's boundary condition (<ref>) is 

𝒞 𝒫_odd f = χ/2-χ 𝒞(f_W - 𝒫_even f),

where 𝒞 is half-space operator defined by

    𝒞g(ξ_n, ξ_t_1, ξ_t_2) = 
      g(ξ_n, ξ_t_1, ξ_t_2),    if ξ_n < 0, 
    
      0,    if ξ_n > 0.

Noting that 𝒫_odd = 2𝒫_odd𝒞𝒫_odd, we can apply 𝒫_odd to both sides of (<ref>) to get

    𝒫_odd f = 2χ/2-χ𝒫_odd𝒞(f_W - 𝒫_even f).

To determine w^0,W in f_W, we need to use (<ref>), which can also be formulated as

    ⟨ψ_n^0, f ⟩ = 0.

The complete Maxwell's boundary condition includes both (<ref>) and (<ref>).



 §.§ A first attempt to formulate boundary conditions for R13 equations

Following the formulation of Maxwell's boundary conditions (<ref>), we will also split the function space for R13 equations into an odd part and an even part:

𝕍 = 𝕍_odd⊕𝕍_even,

where

𝕍_odd = 𝕍 ∩L_odd^2(ℝ^3, [f_M()]^-1  d),     𝕍_even = 𝕍 ∩L_even^2(ℝ^3, [f_M()]^-1  d).

Grad's work <cit.> states that the boundary conditions of moment equations should be formulated by taking only odd moments of the kinetic boundary conditions. Therefore, we expect that the boundary conditions for R13 equations are written as a map from 𝕍_even to 𝕍_odd, which is analogous to (<ref>).

Furthermore, to get Onsager boundary conditions satisfying the L^2 stability, we write the operator 𝒜̅_n = n_j 𝒜̅_j in the following form:

    𝒜̅_n = 𝒜̅_eo𝒫_odd|_𝕍 + 𝒜̅_oe𝒫_even|_𝕍.

Here 𝒫_odd|_𝕍 and 𝒫_even|_𝕍 are the restrictions of 𝒫_odd and 𝒫_even on 𝕍, respectively.
Such a form of 𝒜̅_n can be observed from the equations (<ref>)–(<ref>), and it corresponds to the equation (<ref>) when written in the matrix form. The Onsager boundary conditions should hold the form

    𝒫_odd|_𝕍 f̅ = 𝒮𝒜̅_oe(f_W - 𝒫_even|_𝕍 f̅),

where 𝒮 is a self-adjoint and negative semidefinite operator on 𝕍_odd. Note that (<ref>) is the operator form of the boundary conditions (<ref>). The operator 𝒮 can be figured out by comparing (<ref>) with (<ref>): since 𝒜̅_oe approximates the operation that multiplies an even function by ξ_n, the operator 𝒮 should approximate the operator

2χ/2-χ 𝒫_odd 𝒞 ξ_n^-1,

so that (<ref>) can be regarded as a discretization of (<ref>). Thus, a natural choice is

    𝒮 = 2χ/2-χ𝒫_𝕍𝒫_odd𝒞ξ_n^-1.

Note that 𝒫_𝕍𝒫_odd is the projection operator onto 𝕍_odd, and therefore 𝒮 is an operator on 𝕍_odd. The proposition below shows some desired properties of 𝒮:


The operator 𝒮 is self-adjoint and negative semidefinite.


For any f̅_o,g̅_o∈𝕍_odd, we have


⟨f̅_o, 𝒮g̅_̅o̅ ⟩   = 2χ/2-χ ⟨f̅_o, 𝒫_𝕍𝒫_odd 𝒞 ξ_n^-1 g̅_o⟩= ⟨𝒫_𝕍𝒫_oddf̅_o, 𝒞 ξ_n^-1 g̅_o⟩= ⟨f̅_o, 𝒞 ξ_n^-1 g̅_o⟩

   = ∫_-∞^0 ∫_-∞^+∞ ∫_-∞^+∞ f̅_o(ξ_n, ξ_t_1, ξ_t_2) ξ_n^-1 g̅_o(ξ_n, ξ_t_1, ξ_t_2)  d ξ_t_2  d ξ_t_1  d ξ_n 

   = ⟨𝒞 ξ_n^-1 f̅_o, g̅_o⟩= ⟨𝒞 ξ_n^-1 f̅_o, 𝒫_𝕍𝒫_oddg̅_o⟩= ⟨𝒫_𝕍𝒫_odd 𝒞 ξ_n^-1 f̅_o, g̅_o⟩= ⟨𝒮 f̅_o, g̅_o ⟩, 

⟨f̅_o, 𝒮f̅_o ⟩   = ∫_-∞^0 ∫_-∞^+∞ ∫_-∞^+∞ ξ_n^-1 [f̅_o(ξ_n, ξ_t_1, ξ_t_2)]^2  d ξ_t_2  d ξ_t_1  d ξ_n ≤0,


which shows both properties of 𝒮.


The equation (<ref>) with 𝒮 defined by (<ref>) is still incomplete since the condition for mass conservation (<ref>) has not been considered to determine w^0,W in the definition of f_W. Therefore, we further require that ⟨ψ_n^0, f̅⟩ = 0, or equivalently,

    𝒫_u f̅ = 0,

where 𝒫_u is the projection operator from 𝕍 onto the following subspace:

𝕍_u = span { ψ_n^0 }.

The proposition below shows how we can combine (<ref>) and (<ref>) into one equation:

Let 𝒮_uu be a map from 𝕍_u to 𝕍_u defined by 𝒮_uu = 𝒫_u 𝒮|_𝕍_u. Then for any f̅ satisfying

    𝒫_odd|_𝕍 f̅ = 𝒮̅𝒜̅_oe(f_W - 𝒫_even|_𝕍 f̅)

with

𝒮̅ = (ℐ - 𝒫_u) (ℐ - 𝒮 𝒮_uu^-1 𝒫_u) 𝒮,

both (<ref>) and (<ref>) hold for an appropriately chosen ρ_W. Meanwhile, the operator 𝒮̅ is a self-adjoint and positive semidefinite operator on 𝕍_odd, and it satisfies

    𝒮̅𝒜̅_oe = 𝒮̅𝒜̅_oe (ℐ - 𝒫_ρ),

where 𝒫_ρ: 𝕍_even→𝕍_even is a projection operator defined by 𝒫_ρf̅_e = ⟨f̅_e, ψ^0⟩ψ^0.



The rigorous proof of this proposition can be found in Section <ref> of supplementary material. This proposition shows that we can use (<ref>) as the Onsager boundary conditions for the R13 equations, and the property (<ref>) implies that ρ_W actually does not appear in (<ref>) since

(ℐ - 𝒫_ρ) f_W = w^1,W ψ^1 + 3 w_t_1^0,W ψ_t_1^0 + 3 w_t_2^0,W ψ_t_2^0,

which does not involve ρ_W. Following the abstract form (<ref>), we can write down the boundary conditions explicitly using the series expansion of the distribution functions. Since

{ ψ_n^0, ϕ_n^(1), ϕ_nt_1^(1), ϕ_nt_2^(1), ϕ_n^(2), ϕ_nt_1^(2), ϕ_nt_2^(2), ϕ_nnn^(2), ϕ_nt_1 t_2^(2),  ϕ_nt_1 t_1^(2) + 1/2 ϕ_nnn^(2) }

forms an orthogonal basis of 𝕍_odd (note that ϕ_nt_2 t_2^(2) = -ϕ_nnn^(2) - ϕ_nt_1 t_1^(2)),
ten boundary conditions are to be prescribed for each boundary point. The calculation of the boundary conditions is tedious but straightforward. The results are 

    w_n^0    = 0, 
     u^(1)_n    = 2χ/2-χ[ λ'_11 (w^1 -w^1,W) + λ'_12 u^(1)_nn +  λ'_13 u^(2) +  λ'_14 u^(2)_nn], 
     u^(2)_n    = 2χ/2-χ[ λ'_21 (w^1 -w^1,W) + λ'_22u^(1)_nn +  λ'_23 u^(2) +  λ'_24 u^(2)_nn], 
       u^(1)_t_i n    = 2χ/2-χ[λ'_31 (w^0_t_i -w^0,W_t_i) + λ'_32u^(1)_t_i + λ'_33 u^(2)_t_i  +  λ'_34  u^(2)_t_i nn], 
      u^(2)_t_in    = 2χ/2-χ[ λ'_41 (w^0_t_i -w^0,W_t_i) + λ'_42u^(1)_t_i + λ'_43 u^(2)_t_i + λ'_44  u^(2)_t_i nn], 
      u^(2)_nnn    = 2χ/2-χ[λ'_51 (w^1 -w^1,W) + λ'_52u^(1)_nn +  λ'_53 u^(2) +  λ'_54 u^(2)_nn], 
     u^(2)_t_i t_i n + 1/2 u^(2)_nnn    =  2χ/2-χ[ λ'_61(u^(1)_t_i t_i + c^(2),0_2/c^(1),0_2u^(2)_t_it_i) + λ'_62(u^(1)_nn + c^(2),0_2/c^(1),0_2u^(2)_nn) ], 
      u^(2)_t_1 t_2 n    = 2χ/2-χλ'_71(u^(1)_t_1 t_2 + c^(2),0_2/c^(1),0_2u^(2)_t_1t_2).

The detailed derivation and the expressions of the coefficient λ'_ij are given in Section <ref>.


However, these equations give too many boundary conditions for the R13 equations. The general theory of hyperbolic conditions requires that the number of boundary conditions equal the number of negative eigenvalues of 𝒜̅_n. In our case, 𝒜̅_n has only 9 negative eigenvalues. In other words, the operator 𝒜̅_oe is not surjective.
As mentioned in Section <ref>, this is because our selection of function spaces 𝕍_odd and 𝕍_even are purely based on the symmetry of functions, regardless of the structure of equations. Detailed explanations and the fix of these boundary conditions will be shown in the next subsection.






 §.§ Fixing the boundary conditions

To show why 𝒜̅_oe is not surjective, we multiply the equation (<ref>) by c_1^(2),1/c_1^(1),1, subtract the result from (<ref>), and set the index i to be the normal direction n, yielding the equation


(A_57 - c_1^(2),1/c_1^(1),1 A_45) [     ∂/∂x_n (u_nn^(1) + c_2^(2),0/c_2^(1),0 u_nn^(2) ) + ∂/∂x_t_1 (u_nt_1^(1) + c_2^(2),0/c_2^(1),0 u_nt_1^(2) ) 

    + ∂/∂x_t_2 (u_nt_2^(1) + c_2^(2),0/c_2^(1),0 u_nt_2^(2) ) ] 
= 1/ (ℒ_1^(22) - c_1^(2),1/c_1^(1),1 ℒ_1^(12)) u_n^(2).


Then we set i,j,k to be n in (<ref>): 


3/5 A_59 ∂/∂x_n (u_nn^(1) + c_2^(2),0/c_2^(1),0 u_nn^(2) ) - 2/5 A_59 ∂/∂x_t_1 (u_nt_1^(1) + c_2^(2),0/c_2^(1),0 u_nt_1^(2) ) - 2/5 A_59 ∂/∂x_t_2 (u_nt_2^(1) + c_2^(2),0/c_2^(1),0 u_nt_2^(2) ) 

= 1/ ℒ_3^(22) u_nnn^(2).


The two equations above show that if we perform the linear combination

3/5 A_59 ×[(<ref>)|_i=n - c_1^(2),1/c_1^(1),1 ×(<ref>)|_i=n ] - (A_57 - c_1^(2),1/c_1^(1),1 A_45 ) ×(<ref>)|_i,j,k=n,

the derivatives with respect to x_n will all cancel out on the left-hand side. An equivalent statement is

⟨ϕ_0, 𝒜̅_oe f̅
⟩= 0,     ∀f̅ ∈𝕍,

where

    ϕ_0 = 9/5 A_59(ϕ_n^(2) - c_1^(2),1/c_1^(1),1ϕ_n^(1)) - 35/2(A_57 - c_1^(2),1/c_1^(1),1 A_45) ϕ_nnn^(2).

Let 𝕍_0 = span{ϕ_0} and 𝒫_0 be the associated projection operator. We then have

    𝒫_0 𝒜̅_oe = 0.


Therefore, to fix the boundary conditions, the subspace 𝕍_0 should be removed form 𝕍_odd. This requires replacing the operator 𝒮 with (ℐ - 𝒫_0) 𝒮 (ℐ - 𝒫_0). Thus, the operator 𝒮̅ should be replaced with


    (ℐ - 𝒫_u) [ℐ - (ℐ - 𝒫_0)𝒮(ℐ - 𝒫_0) 𝒮_uu^-1 𝒫_u] (ℐ - 𝒫_0)𝒮(ℐ - 𝒫_0) 

=     (ℐ - 𝒫_u)(ℐ - 𝒫_0) [ℐ - 𝒮(ℐ - 𝒫_0) 𝒮_uu^-1 𝒫_u(ℐ - 𝒫_0)] 𝒮(ℐ - 𝒫_0) 

=     (ℐ - 𝒫_0)(ℐ - 𝒫_u) (ℐ - 𝒮 𝒮_uu^-1 𝒫_u) 𝒮(ℐ - 𝒫_0)  [Since  𝒫_0 𝒫_u = 𝒫_u 𝒫_0 = 0]

=     (ℐ - 𝒫_0) 𝒮̅(ℐ - 𝒫_0).


According to (<ref>), the final boundary conditions should be

(𝒫_odd|_𝕍 - 𝒫_0) f̅ = (ℐ - 𝒫_0) 𝒮̅ (ℐ - 𝒫_0) 𝒜̅_oe(f_W - 𝒫_even|_𝕍  f̅),

which can be further simplified to

    (𝒫_odd|_𝕍 - 𝒫_0)  f̅ = (ℐ - 𝒫_0) 𝒮̅𝒜̅_oe(f_W - 𝒫_even|_𝕍 f̅)

due to (<ref>).

The equation above indicates that the explicit form of the new boundary conditions (<ref>) can be derived by linear combinations of the boundary conditions (<ref>)–(<ref>). Using the expression of ϕ_0 (<ref>), we can find the following orthogonal basis of the orthogonal complement of 𝕍_0 in 𝕍:

    {ψ_n^0, ϕ_nt_1^(1), ϕ_nt_2^(1), ϕ_nt_1^(2), ϕ_nt_2^(2), ϕ_nt_1 t_2^(2),  ϕ_nt_1 t_1^(2) + 1/2ϕ_nnn^(2),  ϕ_n^(1) + c^(2),1_1/c^(1),1_1ϕ_n^(2),μ_1 ϕ_nnn^(2) + μ_2 ( ϕ_n^(2) - c^(2),1_1/c^(1),1_1ϕ_n^(1))},

where 












    μ_1 = 3 A_59[ 1 + ( c_1^(2),1/c_1^(1),1)^2 ],     μ_2 = 2( A_57 - c_1^(2),1/c_1^(1),1 A_45).

Therefore, in the new boundary conditions, the equations (<ref>)(<ref>)(<ref>)(<ref>)(<ref>) are preserved, and the two boundary conditions associated with the last two basis functions in (<ref>) are

    u^(1)_n + c_1^(2),1/c_1^(1),1 u^(2)_n      = 2χ/2-χ[ κ_11 (w^1 -w^1,W) + κ_12 u^(1)_nn +  κ_13 u^(2) +  κ_14 u^(2)_nn], 
    μ_1 u_nnn^(2) + μ_2 u^(2)_n - c_1^(2),1/c_1^(1),1μ_2 u^(1)_n     = 2χ/2-χ[κ_21 (w^1 -w^1,W) + κ_22 u^(1)_nn +  κ_23 u^(2) +  κ_24 u^(2)_nn],

where

    κ_1j = λ'_1j + c_1^(2),1/c_1^(1),1λ'_2j,   κ_2j = μ_1 λ'_5j + μ_2 ( λ'_2j - c_1^(2),1/c_1^(1),1λ'_1j),      j = 1,2,3,4.

Our final boundary conditions presented in Section <ref> are obtained by rewriting these boundary conditions using the physical quantities ρ, θ, v_i, q_i and σ_ij, whose derivation needs (<ref>)–(<ref>) and (<ref>) for conversion.


For Maxwell molecules, due to the nonexistence of the variable u_n^(2), the boundary condition (<ref>) does not exist. Therefore, such a fix is unnecessary.





§ RESULTS OF ONE-DIMENSIONAL CHANNEL FLOWS

 
Compared with the boundary conditions of R13 equations proposed in <cit.>, our boundary conditions have a nicer structure that agrees with the form (<ref>). However, it is unclear whether the acquirement of this structure will harm the accuracy of the model. In this section, we will reuse the examples for one-dimensional channel flows in <cit.> to test our models.



 §.§ Problem settings and reduced moment equations

We consider the gas flow between two infinitely large parallel plates in steady state (see Figure <ref>). The distance between the two plates is L, and both plates are perpendicular to the x_2-axis. The temperatures of the left and right plates are respectively given by θ_W^l and θ_W^r. Both plates can move inside their own plane, and we choose the reference frame and the coordinates such that both velocities are parallel to the x_1-axis. Under such settings, all the moments are functions of x_2 only. Due to mass conservation, v_2=0. In addition, we have the symmetry f(ξ_1,ξ_2,ξ_3) = f(ξ_1,ξ_2,-ξ_3) since the plates only move along x_1, and thus all the moments that are odd in ξ_3 vanish. In specific, we have 

    v_3 = q_3 = σ_13 = σ_23 = 0.

Furthermore, since σ_ij is trace-free, σ_33 is automatically obtained once σ_11 and σ_22 are known. Therefore, the 13 moments in our problem can be reduced to eight variables including


  * Equilibrium variables including density ρ, temperature θ, and the velocity component parallel to the plates v_1;

  * Components of the stress tensor including the parallel stress σ_11, normal stress σ_22 and the shear stress σ_12;

  * Heat fluxes including the parallel heat flux q_1 and the normal heat flux q_2.



 
The 13-moment equations (<ref>)–(<ref>) for the one-dimensional channel flows can be immediately obtained by dropping all partial derivatives with respective to x_1 and x_3. As a result, the conservation laws become

    σ_12/ x_2 = 0,     ρ/ x_2 +  θ/ x_2 +  σ_22/ x_2 = 0,      q_2/ x_2 = 0.

The equation of stress tensor σ_11, σ_22 and σ_12 are 

    1/ℒ^(11)_2σ_11 + 5 (c^(1),0_2)^2 β_4   q_2/ x_2 - c^(1),0_2/3β_3 ^2 σ_11/ x^2_2 + c^(1),0_2/3(β_1 + 2/5β_3)  ^2 σ_22/ x^2_2 = 0,
    1/ℒ_2^(11)σ_22 - 10 (c^(1),0_2)^2 β_4  q_2/ x_2-  c^(1),0_2 (2/3β_1 + 3/5β_3)  ^2 σ_22/ x^2_2 = 0,
    1/ℒ^(11)_2 σ_12 - 15/2(c^(1),0_2)^2 v_1/ x_2 - 15/2 (c^(1),0_2)^2 β_4  q_1/ x_2-  c^(1),0_2 (1/2β_1 + 8/15β_3)  ^2 σ_12/ x^2_2 = 0.

The equations of heat flux q_1 and q_2 are

    1/ℒ^(11)_1 q_1 - 15/2 (c^(1),1_1)^2 β_4  σ_12/ x_2 - c^(1),1_1/2β_2 ^2 q_1/ x^2_2 = 0,
    1/ℒ^(11)_1 q_2 - 15/2 (c^(1),1_1)^2 β_4 σ_22/ x_2 -  c^(1),1_1 (β_0  + 2/3β_2) ^2 q_2/ x^2_2 - 15/2(c^(1),1_1)^2 θ/ x_2 = 0.


The general solution of this linear system can be found analytically. By the conservation laws, we see that σ_12, ρ + θ + σ_22 and q_2 are all constants. Then we can solve q_1 and v_1 from (<ref>)(<ref>) and solve q_2 and θ from (<ref>)(<ref>).
Afterwards, ρ and σ_11 can be immediately obtained by solving (<ref>) once other quantities are known. The general solution will include 11 constants to be determined. One of the constants depends on the average density between the plates: upon setting the range of x_2 to be [-1/2, 1/2] (so that L = 1), we assign the average density as  

    ∫_-1/2^1/2ρ(x_2)  dx_2 = 0.

The other 10 constants will be determined by 10 boundary conditions, of which each boundary has five given by (<ref>)–(<ref>) in the one-dimensional setting. Below we provide the boundary conditions on the right wall:

    q_2 =     χ_r/2 - χ_r[ 2λ_11 (θ - θ^W_r) + 2λ_12σ_22 + (2λ_13 + 4/3λ_14)  q_2/ x_2], 
    σ_12 =     χ_r/2 - χ_r[  2λ_21(v_1 - v^W_r) + 2λ_22 q_1 + (2λ_23 + 16/15λ_24 )σ_12/ x_2],  
     q_1/ x_2 =     χ_r/2 - χ_r[ 4λ_31 (v_1 - v^W_r) + 4λ_32q_1 + (4λ_33 + 32/15λ_34 )σ_1 2 / x_2],  
    
         (λ_45+ 3/5)σ_22/ x_2 =     χ_r/2 - χ_r[ 2λ_41 (θ - θ^W_r) + 2λ_42σ_22 + (2λ_43 + 4/3λ_44)  q_2/ x_2], 
    (2 σ_ 11/ x_2  +  σ_ 22/ x_2 ) =     χ_r/2-χ_r(12λ_51σ_11 + 12λ_52σ_22).

For the boundary conditions on the left solid wall, one only needs to make the following replacement of parameters:

q_2 →-q_2,   σ_12 →-σ_12,   x_2 →-x_2,   χ_r →χ_l,   θ^W_r →θ^W_l,   v^W_r →v^W_l.

In the next two subsections, two special cases will be considered to verify our model.



 §.§ Results

In this section, we illustrate the analytic solutions of R13 equations (<ref>)–(<ref>) with the Onsager boundary conditions (<ref>)–(<ref>) using the examples of one-dimensional Couette and Fourier flows in <cit.>. The results will be compared with reference solutions by DSMC simulations which are obtained by Bird's code <cit.>.  

Following the examples in <cit.>, we consider the inverse-power-law model which assumes that the force F between two molecules is proportional to an inverse power of the distance r between them as F = κ r^-η, where η and κ are positive parameters. After nondimensionalization as done in <cit.>, the parameter κ will be integrated into the Knudsen number , and we choose =0.05 and 0.1 in our tests. For the parameter η, we take three values η =5,10 and ∞. In particular, when η =5, the inverse-power-law model becomes Maxwell molecules and the corresponding moment equations are identical to those derived in <cit.>; the choice η = 10 is often used in the simulation of the argon gas; when η→∞, the model reduces to the hard-sphere model <cit.>. Different choices of η will result in different values of a_lmn in the collision operator (<ref>). Thus, the coefficients appearing in the moment equations such as ℒ^(mn)_l and β_i as well as λ_ij in the boundary conditions all rely on the choice of η. We list the numerical values of these coefficients in the supplementary material for reference. In addition, both plates are assumed to be completely diffusive, that is, the accommodation coefficients are χ_l = χ_r =1. 

The results are plotted in Figure <ref> and <ref> for the Couette flow and the Fourier flow. The horizontal axis in each subfigure is x_2, and the vertical axis is the value of the variables we are interested in for the one-dimensional channel problems with Knudsen numbers =0.05 and 0.1. The R13 results are plotted as the blue, yellow and green solid lines for η =5,10 and ∞, and the corresponding reference solutions by DSMC are given by the dotted lines with the same colors. Detailed descriptions of these figures are given in the following subsections.



  §.§.§ Results of the Couette flow

In the planar Couette flow, the two plates have the same temperature and move in opposite directions (see Figure <ref>). In our test, we select θ_l^W = θ_r^W = 0 and v_l^W = -v_r^W = 0.2. In Figure <ref>, we plot the results of v_1, σ_12 and q_1 for Couette flow. As can be seen, the solid curves by R13 solutions generally agree with the dotted curves by the DSMC reference solutions, and they match better for smaller , which implies the validity of our models. Note that due to the lack of nonlinearity, the other five variables (ρ, θ, σ_11, σ_22 and q_2) are all zero in the analytical solutions.






  §.§.§ Results of the Fourier flow

For the Fourier flow, the two plates are stationary, i.e, v^W_r = v^W_l = 0, and the flow is driven solely by the difference of plate temperatures. In our simulations, we set θ^W_l = 0 and θ^W_r =0.2. Due to the simplicity of the structure, the Fourier flow relies less on the nonlinear contributions and we may look at some other variables that we have not shown in Figure <ref> for Couette flow. In Figure <ref>, we plot the results for θ , σ_22 and q_2. Again, the R13 solutions (solid lines) provide qualitatively correct results as expected, showing that our linear R13 model works for the Fourier flow as well. In general, despite the enforcement of a symmetric structure, our models provide almost equal qualities as the equations in <cit.>.







§ CONCLUSION


This paper performs a re-derivation of the linear steady-state regularized 13-moment equations of general gas molecules from a novel point of view. Our derivation is based on a decomposition of the function space according to the order of accuracy, which provides a clearer picture of the entire procedure and gains a symmetric structure in the final system. This also allows a straightforward approach to obtaining Onsager boundary conditions. As an ongoing work, we are trying to apply this approach to time-dependent equations. Extensions to other kinetic equations such as the radiative transfer equation will also be considered in our future work.





plain







Supplementary materials: Linear regularized 13-moment equations with Onsager boundary conditions for general gas molecules














§ DERIVATION OF MOMENT EQUATIONS (<REF>)


Given any tensors A^m_i_1⋯ i_l for all l,m = 0,1,⋯, the basis functions ψ^m_i_1,⋯,i_l satisfy the following relation <cit.>:

    ∑_m,l=0^+∞ A^m_i_1⋯ i_l⟨  f_M ψ^m_i_1⋯ i_l,ψ^n_j_1⋯ j_l'⟩ =  l'!/(2l'+1)!! A^n_⟨ j_1⋯ j_l'⟩.

Using this property, we can derive (<ref>) by multiplying the Boltzmann equation (<ref>) by ψ_i_1⋯ i_l^n and then integrating with respect to . The calculation of the right-hand side is the as follows:

    1/⟨ℒ[f], ψ_i_1,⋯,i_l^n ⟩   =
    1/∑_m,k=0^+∞(2k+1)!!/k!w_j_1,⋯,j_k^m  ⟨ℒ[ψ^m_j_1,⋯,j_k f_M], ψ^n_i_1,⋯,i_l⟩
        = 1/∑_m,k=0^+∞∑_n'=0^+∞ a_kmn'(2k+1)!!/k!w_j_1,⋯,j_k^m ⟨ f_M  ψ^n'_j_1,⋯,j_k, ψ^n_i_1,⋯,i_l⟩
        = 1/∑_n'=0^+∞ a_lnn' w_i_1,⋯, i_l^n',

where we have used (<ref>) to expand ℒ[ψ^m_j_1,⋯,j_k].
For the left-hand side, we need another property from <cit.>:

    ψ^n_i_1⋯ i_lξ_j = ( √(2(n+l)+3)ψ^n_i_1 ⋯ i_l j - √(2n)ψ^n-1_i_1 ⋯ i_l j)+
                 + l/2l+1( √(2(n+l)+1)ψ^n_⟨ i_1 ⋯ i_l-1δ_i_l⟩ j   -√(2(n+1))ψ^n+1_⟨  i_1 ⋯ i_l-1δ_i_l⟩ j),

using which we have

    ⟨ξ_j ∂ f/∂ x_j, ψ_i_1,⋯,i_l^n ⟩   =
      ⟨∂ f/∂ x_j, ψ_i_1,⋯,i_l^n ξ_j ⟩
      = ∑_m,k=0^+∞(2k+1)!!/k!∂ w_j_1,⋯,j_k^m /∂ x_j⟨ f_M ψ^m_j_1,⋯,j_k,  ψ^n_i_1,⋯,i_lξ_j ⟩
       = ( √(2(n+l)+3)∂ w_i_1⋯ i_l j^n/∂ x_j - √(2n)∂ w_i_1⋯ i_l j^n-1/∂ x_j) 
            + l/2l+1( √(2(n+l)+1)∂ w_⟨ i_1⋯ i_l-1^n/∂ x_i_l ⟩ - √(2(n+1))∂ w_⟨ i_1⋯ i_l-1^n+1/∂ x_i_l⟩).
 
Equating (<ref>) and (<ref>) gives the moment equations (<ref>).




§ PROOF OF (O0)-(O4)

Similar as (<ref>), T_i_1⋯ i_l^n can also be expanded as 

    T_i_1⋯ i_l^n =  T_i_1⋯ i_l^n|0 +  T_i_1⋯ i_l^n|1 + ^2 T_i_1⋯ i_l^n|2 + ^3 T_i_1 ⋯ i_l^n|3 + ⋯.




 §.§ Zeroth order

To find the zeroth-order terms in the asymptotic expansion (<ref>), we insert (<ref>)(<ref>) into (<ref>) and balance the O(^-1) terms on both sides. The result is

    ∑_n'=0^+∞ a_lnn' w_i_1⋯ i_l^n'|0 = 0

For l ≥ 2, we can multiply both sides by b_ln_1n^(0) and take the sum over n, which gives us

w_i_1⋯i_l^n_1|0 = 0,     ∀n_1 ⩾0.

When l = 0 and l = 1, due to the relations (<ref>), we can multiply both sides of (<ref>) by b_0n_1n^(2) or b_1n_1n^(1) and then take the sum over n, to obtain

w^n|0 = 0,   ∀n ⩾2,     and     w_i^n|0 = 0,   ∀n ⩾1.
   
The values of w^0|0, w_i^0|0 and w^1|0 are allowed to be nonzero, and thus we reach to the conclusion (O0). Following the idea of the Chapman-Enskog expansion, we assume that

    w^0|k = w^1|k = w_i^0|k = 0,     ∀ k ⩾ 1.

Using these results, we can find the following zeroth-order terms for T_i_1 ⋯ i_l^n:

    T^n|0 = 0,      n ⩾ 2, 
    
    T_i^1|0 = √(5)/3∂ w^1/∂ x_i,   
    T_i^n|0 = 0,      n ⩾ 2, 
    
    T_ij^0|0 =  2/√(5)∂ w_⟨ i^0/∂ x_j⟩,   
    T_ij^n|0 = 0,      n ⩾ 1,
    
    T_i_1 ⋯ i_l^n|0 = 0,      l ⩾ 3,    n ⩾ 0.

These results are to be used in the derivation of first-order terms.



 §.§ First order

By inserting (<ref>)(<ref>) into (<ref>) and balancing the O(1) terms on both sides, we get

    T_i_1⋯ i_l^n|0 = ∑_n'=0^+∞ a_lnn' w^n'|1_i_1⋯ i_l.




  
Expressions of w_i_1⋯ i_l^n|1 for l = 0 and l ⩾ 3
When l = 0 and n ⩾ 2, the left-hand side of the above equation is zero, and therefore

    w^n|1 = 0,      n ⩾ 2.

Similarly,

    w_i_1⋯ i_l^n|1 = 0,     if  l ⩾ 3  and  n ⩾ 0.




  
Expressions of w_i^n|1
Using (<ref>), we have

   √(5)/3 ∂w^1/∂x_i  = ∑_n'=1^+∞ a_11n' w_i^n'|1  and 
 ∑_n'=1^+∞ a_1nn' w_i^n'|1 = 0,  for  n ⩾2.

Hence,

    w_i^n|1 = √(5)/3 b_11n^(1)∂ w^1/∂ x_i

which produces the expression (<ref>). Similar to the Chapman-Enskog expansion, here we would like to assume that

    w_i^1|k = 0,     for all  k ⩾ 2.







  
Expressions of w_ij^n|1
Following the similar argument for the case l = 1 upon using (<ref>), we have

    w_ij^n|1 = 2/√(5) b_20n^(0)∂ w_⟨ i^0/∂ x_j⟩,

which yields the relation (<ref>). Again, since w_ij^0 appears in the final equations, instead of (<ref>), we are going to assume

    w_ij^0|k = 0,     for all  k ⩾ 2.









By (<ref>) and (<ref>), we conclude that {w^n_i}_n=1^∞, {w^n_ij}_n=0^∞ are only first order moments in the expansion of distribution function and thus we arrive at the statement (O1). By inserting the above results (<ref>)(<ref>)(<ref>)(<ref>) into (<ref>), we can obtain the expressions of T_i_1⋯ i_l^n|1. When l ⩾ 4, it is easy to see from (<ref>) that T_i_1⋯ i_l^n|1 = 0. For l = 0,1,2,3, these quantities are given as follows:



  
Expressions of T^n|1
By the relation (<ref>), it holds that

    T^n|1 = √(2n+3)∂ w_j^n|1/∂ x_j - √(2n)∂ w_j^n-1|1/∂ x_j 
    = √(2n+3) b_11n^(1) - √(2n) b_11,n-1^(1)/b_111^(1)∂ w_j^1|1/∂ x_j

for n ⩾ 1. Note that when n = 1, the coefficient b_110^(1) should be regarded as zero since w_j^0|1 = 0 by the assumption (<ref>).



  
Expressions of T_i^n|1
By the relation (<ref>), we have

    T_i^n|1 = √(2n+5)∂ w_ij^n|1/∂ x_j - √(2n)∂ w_ij^n-1|1/∂ x_j 
    = √(2n+5) b_20n^(0) - √(2n) b_20,n-1^(0)/b_200^(0)∂ w_ij^0|1/∂ x_j

for n⩾ 1.






  
Expressions of T_ij^n|1
By the relation (<ref>), we have 

    T_ij^n|1 = 2/5( √(2n+5)∂ w_⟨ i^n|1/∂ x_j⟩ - √(2(n+1))∂ w_⟨ i^n+1|1/∂ x_j⟩) 
    = 2/5√(2n+5) b_11n^(1) - √(2(n+1)) b_11,n+1^(1)/b_111^(1)∂ w_⟨ i^1|1/∂ x_j ⟩

for n ⩾ 0, where the coefficient b_110^(1) should be regarded as zero when n=0 again by the assumption (<ref>).





  
Expressions of T_ijk^n|1
Since w_ijkl^n|1 = 0, by the relation (<ref>) we have

    T_ijk^n|1 = 3/7( √(2n+7)∂ w_⟨ ij^n|1/∂ x_k⟩ - √(2(n+1))∂ w_⟨ ij^n+1|1/∂ x_k⟩) 
    = 3/7√(2n+7) b_20n^(0) - √(2(n+1)) b_20,n+1^(0)/b_200^(0)∂ w_⟨ ij^0|1/∂ x_k ⟩




 §.§ Second order

We now find the second-order moments in the expansion of distribution function based on 

    T_i_1⋯ i_l^n|1 = ∑_n'=0^+∞ a_lnn' w^n'|2_i_1⋯ i_l.



  
Expressions of w^n|2
By (<ref>), we have

    w^n|2 = ∑_n'=2^+∞ b_0nn'^(2) T^n'|1 
    = γ^(2),n_0 ∂ w_j^1|1/∂ x_j

for n⩾ 2, where γ^(2),n_0 is defined in (<ref>). Note that the summation begins from n'=2 due to the assumption (<ref>).







  
Expressions of w_i^n|2
By (<ref>), we have

    w_i^n|2 = ∑_n'=2^+∞ b_1nn'^(2) T_i^n'|1 
    =γ^(1),n_1∂ w_ij^0|1/∂ x_j

for n⩾ 2, where γ^(1),n_1 is defined in (<ref>). Note that the summation begins from n'=2 due to the assumption (<ref>).





  
Expressions of w_ij^n|2
By (<ref>), we have 

    w_ij^n|2 = ∑_n'=1^+∞ b_2nn'^(1) T_ij^n'|1 
    =  γ^(1),n_2 ∂ w_⟨ i^1|1/∂ x_j⟩,

for n ⩾ 1, where γ^(1),n_2 is defined in (<ref>). Note that the summation begins from n'=1 due to the assumption (<ref>).




  
Expressions of w_ijk^n|2
By (<ref>), we have

    w_ijk^n|2 = ∑_n'=0^+∞ b_3nn'^(0) T_ijk^n'|1 =
    γ^(2),n_3 ∂ w_⟨ ij^0|1/∂ x_k⟩

for any non-negative n, where γ^(2),n_3 is defined in (<ref>).









  
Expressions of w_i_1⋯ i_l^n|2 for l ⩾ 4
When l ⩾ 4, since T_i_1⋯ i_l^n|1 = 0, we have

w_i_1⋯i_l^n|2 = 0.


At this point, we may conclude that {w^n}_n=2^∞ and {w^n_ijk}_n=0^∞ are the all second-order moments in the expansion of distribution function, and thus we arrive at (O2). Finally, the statement (O3) is the direct conclusion from 

    w_ijkl^n|3 = ∑_n'=0^+∞ b_4nn'^(0) T_ijkl^n'|2 ∼O(^3),

while (O4) comes from 

   w_i_1⋯i_l^n|3 = ∑_n'=0^+∞ b_lnn'^(0) T_i_1⋯i_l^n'|2 = 0 

as T_i_1⋯ i_l^n|2 = 0 when l ⩾ 5.


























§ PROOF OF PROPOSITION <REF>

We first claim that 𝒮̅ = 𝒮̅ (ℐ - 𝒫_u), or equivalently, 𝒮̅𝒫_u = 0. This can be shown by direct calculation:

    𝒮̅𝒫_u    = (ℐ - 𝒫_u) (ℐ - 𝒮𝒮_uu^-1𝒫_u) 𝒮𝒫_u = (ℐ - 𝒫_u) 𝒮𝒫_u - (ℐ - 𝒫_u) 𝒮𝒮_uu^-1𝒫_u 𝒮𝒫_u 
       = (ℐ - 𝒫_u) 𝒮𝒫_u - (ℐ - 𝒫_u) 𝒮𝒫_u = 0.

Since 𝕍_ρ⊂𝕍^(0) and 𝕍_ρ⊂𝕍_even, we can see from (<ref>) and (<ref>) that

𝒜̅_oe 𝒫_ρ = 𝒜̅_n 𝒫_ρ = 𝒫_𝕍 ξ_n 𝒫_ρ.

Thus, by ξ_n ψ^0 = ψ_n^0 ∈𝕍_u, we get 𝒜̅_oe𝒫_ρ = 𝒫_u ξ_n 𝒫_ρ. Therefore, one can derive from (<ref>) that

𝒮̅ 𝒜̅_oe 𝒫_ρ = 𝒮̅ 𝒫_u ξ_n 𝒫_ρ = 0,

which proves (<ref>).

The proof of (<ref>) is straightforward. Using 𝒫_u 𝒮̅ = 𝒫_u (ℐ - 𝒫_u) ⋯ = 0, we can find that

𝒫_u f̅ = 𝒫_u 𝒫_odd |_𝕍 f̅ = 𝒫_u 𝒮̅ 𝒜̅_oe(f_W - 𝒫_even|_𝕍  f̅) = 0.

To show (<ref>), we need to choose ρ_W such that

𝒫_u 𝒮 𝒜̅_oe (f_W - 𝒫_even|_𝕍 f̅) = 0.

When (<ref>) holds, one can use the two equalities above to obtain


𝒫_odd|_𝕍   f̅    = 𝒫_u f̅ + (ℐ - 𝒫_u) 𝒫_odd|_𝕍   f̅ = 0 + (ℐ - 𝒫_u) 𝒮̅ 𝒜̅_oe(f_W - 𝒫_even|_𝕍  f̅) 

   = (ℐ - 𝒫_u) (ℐ - 𝒮 𝒮_uu^-1 𝒫_u)𝒮 𝒜̅_oe(f_W - 𝒫_even|_𝕍  f̅) 

   = (ℐ - 𝒫_u) 𝒮 𝒜̅_oe(f_W - 𝒫_even|_𝕍  f̅) - (ℐ - 𝒫_u)𝒮 𝒮_uu^-1 𝒫_u 𝒮 𝒜̅_oe(f_W - 𝒫_even|_𝕍  f̅) 

   = (ℐ - 𝒫_u) 𝒮 𝒜̅_oe(f_W - 𝒫_even|_𝕍  f̅) = 𝒮 𝒜̅_oe(f_W - 𝒫_even|_𝕍  f̅).


This proves (<ref>).

It remains to show that 𝒮̅ is self-adjoint and positive semidefinite. Its self-adjointness can be seen by rewriting the expression of 𝒮̅ as

𝒮̅ = 𝒮̅ (ℐ - 𝒫_u) = (ℐ - 𝒫_u)(𝒮 - 𝒮 𝒫_u 𝒮_uu^-1 𝒫_u 𝒮) (ℐ - 𝒫_u).

For any g̅∈𝕍_odd, we can define g = (ℐ - 𝒮_uu^-1𝒫_u 𝒮)(ℐ - 𝒫_u) g̅ and verify that

⟨g̅, 𝒮̅ g̅ ⟩= ⟨g, 𝒮 g ⟩.

Therefore, the positive semidefiniteness of 𝒮̅ follows the positive semidefiniteness of 𝒮.







§ EXPRESSIONS OF COEFFICIENTS



 §.§ Expressions of c^(d),n_l



    
  * Coefficients in the first-order moments: The expressions of c^(1),n_1 and c^(1),n_2 are given by 
    
    c^(1),n_1 =     b_11n^(1)/√(∑^+∞_n=1(b^(1)_11n)^2 ),  for  n⩾ 1
    
            c^(1),n_2 =     b_20n^(0)/ √(∑^+∞_n=0(b^(0)_20n)^2 ),  for  n⩾ 0,

    where b^n_0_lnn' can be obtained from (<ref>).
    
  * Coefficients in the first-order moments: The expressions of c^(2),n_0 and c^(2),n_3 are given by 
        
    c^(2),n_0 =     γ^(2),n_0 / √(∑^+∞_n=2( γ^(2),n_0)^2 ),  for  n⩾ 2,
    
            c^(2),n_3 =     γ^(2),n_3 /√(∑^+∞_n=0(γ^(2),n_3)^2 ),  for  n⩾ 0

  where γ^(2),n_0 and γ^(2),n_3 are respectively given by (<ref>) and (<ref>). (<ref>) and (<ref>). 

For non-Maxwell molecules, the expressions of c^(2),n_1 and c^(2),n_2 are given by 

 
 c^(2),n_1 =       1/C^(2)_1 ×
  - ∑_n'=2^+∞ c̅^n'_1 b^(1)_11n'/b^(1)_111,      if    n=1

    c̅^n_1 ,      if    n⩾2

  , 
 
  c^(2),n_2 =      1/C^(2)_2 ×
  - ∑_n'=1^+∞ c̅^n'_2 b^(0)_20n'/b^(0)_200,      if    n=0

    c̅^n_2 ,      if    n ⩾1

 
  

where C^(2)_1, C^(2)_1 are constants chosen such that the scaling 

    ∑_n=1^+∞|c_1^(2),n|^2 = ∑_n=0^+∞|c_2^(2),n|^2 = 1

holds, and c̅^n_1, c̅^n_2 are respectively the solutions of the linear system 

    [                      τ^2_3                      τ^3_3    α_3 b^(1)_114/b^(1)_111    α_3 b^(1)_115/b^(1)_111                          ⋯    α_3 b^(1)_11D/b^(1)_111                          ⋯;                      τ^2_4    α_4 b^(1)_113/b^(1)_111                      τ^4_4    α_4 b^(1)_115/b^(1)_111                          ⋯    α_4 b^(1)_11D/b^(1)_111                          ⋯;                          ⋮                          ⋮                          ⋮                          ⋮                          ⋱                          ⋮                          ⋱;                      τ^2_D    α_D b^(1)_113/b^(1)_111    α_D b^(1)_114/b^(1)_111                          ⋯ α_D b^(1)_11,D-1/b^(1)_111                      τ^D_D                          ⋯;                          ⋮                          ⋮                          ⋮                          ⋮                          ⋱                          ⋮                          ⋱ ][   c̅^2_1;   c̅^3_1;        ⋮; c̅^D-1_1;   c̅^D_1;        ⋮ ] = 0

where 

  τ^2_D = b^(1)_112/b^(1)_111α_D - γ^(1),D_1/γ^(1),2_1, τ^D_D = b^(1)_11D/b^(1)_111α_D + 1,    α_D =  b^(1)_11D/b^(1)_111 - γ^(1),D_1/γ^(1),2_1 b^(1)_112/b^(1)_111   with  c̅^2_1 = 1

and 

    [                      τ̃^1_2                      τ̃^2_2    α̃_2 b^(0)_203/b^(0)_200    α̃_2 b^(0)_204/b^(0)_200                           ⋯    α̃_2 b^(0)_20D/b^(0)_200                           ⋯;                      τ̃^1_3    α̃_3 b^(0)_202/b^(0)_200                      τ̃^3_3    α̃_3 b^(0)_204/b^(0)_200                           ⋯    α̃_3 b^(0)_20D/b^(0)_200                           ⋯;                           ⋮                           ⋮                           ⋮                           ⋮                           ⋱                           ⋮                           ⋱;                      τ̃^1_D    α̃_D b^(0)_202/b^(0)_200    α̃_D b^(0)_203/b^(0)_200                           ⋯ α̃_D b^(0)_20,D-1/b^(0)_200                      τ̃^D_D                           ⋯;                           ⋮                           ⋮                           ⋮                           ⋮                           ⋱                           ⋮                           ⋱ ][   c̅^1_2;   c̅^2_2;        ⋮; c̅^D-1_2;   c̅^D_2;        ⋮ ] = 0

where 

  τ̃^1_D = b^(0)_201/b^(0)_200α̃_D - γ^(1),D_2/γ^(1),1_2,  τ̃^D_D = b^(0)_20D/b^(0)_200α̃_D + 1,   α̃_D =  b^(0)_20D/b^(0)_200 - γ^(1),D_2/γ^(1),1_2 b^(0)_201/b^(0)_200  with  c̅^2_1 = 1.

For Maxwell molecules, we have 

  c^(2),n_1 = 0   for  n⩾1  and  c^(2),n_2 = 
        1,      if  n = 1

          0 ,      if  n=0  or  n ⩾2
    .









 §.§ Expressions of A_ij



    A_ij = 
             3  ∑_n=1^+∞c^(1),n_1 (√(2n+5)c^(1),n_2 - √(2n)c^(1),n-1_2 ),     if   (i,j)=(4,5)
    ∑_n=1^+∞  c^(1),n_1 ( √(2n+3)c^(2),n_0 - √(2(n+1))c^(2),n+1_0 ),    if   (i,j)=(4,6)
    
              3  ∑_n=1^+∞c^(1),n_1 (√(2n+5)c^(2),n_2 - √(2n)c^(2),n-1_2 ),    if   (i,j)=(4,8)
    
              3   ∑_n=0^+∞ c^(1),n_2 ( √(2n+5)c^(2),n_1 - √(2(n+1)) c^(2),n+1_1 ) ,    if   (i,j)=(5,7)
    15/2∑_n=0^+∞ c^(1),n_2 ( √(2n+7) c^(2),n_3 - √(2n)c^(2),n-1_3 ) ,    if   (i,j)=(5,9)
    ∑_n=2^+∞ c^(2),n_0 ( √(2n+3) c^(2),n_1 - √(2n)c^(2),n-1_1 ),    if   (i,j)=(6,7) 
    
              3  ∑_n=1^+∞c^(2),n_1 (√(2n+5)c^(2),n_2 - √(2n)c^(2),n-1_2 ),     if   (i,j)=(7,8)
    15/2∑_n=0^+∞ c^(2),n_2 ( √(2n+7) c^(2),n_3 - √(2n)c^(2),n-1_3 )  ,     if   (i,j)=(8,9)











 §.§ Expressions of λ'_ij

The boundary conditions (<ref>) can be written uniformly as 

    w_n^0 = 0, 
        u_i_1⋯ i_l^(p) = 2χ/2-χ∑_m c^(p),m_l [
         3∑_p'=1,2∑^+∞_m'=1  c^(p'),m'_1  ( A^m'_m;i_1⋯ i_l - A^m'_0;nI^0_m;i_1 ⋯ i_l/I^0_0;n) z^(p')_n
         + 15 ∑_t=t_1,t_2∑_p'=1,2∑^+∞_m'=0   c^(p'),m'_2  B^m';t_m;i_1 ⋯ i_l z^(p')_tn + 35/2∑^+∞_m'=0  c^(2),m'_3( D^m'_m;i_1⋯ i_l - D^m'_0;nI^0_m;i_1 ⋯ i_l/I^0_0;n) z^(2)_nnn
        + 105/2∑_t',t”=t_1,t_2∑^+∞_m'=0  c^(2),m'_3 (  C^m';t't”_m;i_1⋯ i_l -C^m';t't”_0;nI^0_m;i_1 ⋯ i_l/I^0_0;n) z^(2)_t't”n],

where u_i_1⋯ i_l^(p) is taken in the set {u^(1)_n, u^(2)_n, u^(1)_t_1 n, u^(1)_t_2 n, u^(2)_t_1 n, u^(2)_t_2 n, u^(2)_nnn, u^(2)_t_1 t_1 n, u^(2)_t_2 t_2 n, u^(2)_t_1 t_2 n}, and the coefficients are given by

    I_m;i_1 ⋯ i_l^m';j_1 ⋯ j_k    =   ∫_· < 0 f_M() L̅_m'^(k+1/2)( ||^2/2)L̅_m^(l+1/2)( ||^2/2) ξ_⟨ i_ 1⋯ξ_i_l⟩ξ_⟨ j_ 1⋯ξ_j_k⟩ ,
    A^m'_m;i_1 ⋯ i_l    =  ∫_· < 0 f_M() L̅_m'^(3/2)( ||^2/2)L̅_m^(l+1/2)( ||^2/2) ξ_⟨ i_ 1⋯ξ_i_l⟩ ,
    B^m';t_j_m;i_1 ⋯ i_l    = ∫_· < 0 f_M() L̅_m'^(5/2)( ||^2/2)L̅_m^(l+1/2)( ||^2/2) ξ_⟨ i_ 1⋯ξ_i_l⟩ξ_t_j , 
    C^m';t' t”_m;i_1 ⋯ i_l    = ∫_· < 0 f_M() L̅_m'^(7/2)( ||^2/2)L̅_m^(l+1/2)( ||^2/2) ξ_⟨ i_ 1⋯ξ_i_l⟩·ξ_⟨ t'ξ_t”ξ_n⟩/ξ_n , 
    D^m'_m;i_1 ⋯ i_l    = ∫_· < 0 f_M() L̅_m'^(7/2)( ||^2/2)L̅_m^(l+1/2)( ||^2/2) ξ_⟨ i_ 1⋯ξ_i_l⟩·ξ_⟨ nξ_nξ_n⟩/ξ_n

where z_i_1⋯ i_l^(k) are the coefficients in the expansion of 𝒜̅_oe (f_W - 𝒫_even|_𝕍f̅):

    z^(1)_n =     1/3(√(5)c^(1),1_1(w^1,W-w^1) -A_45u^(1)_nn-A_46u^(2)-A_48u^(2)_nn),
    
        z^(2)_n =     1/3(√(5)c^(2),1_1 (w^1,W-w^1) - A_57u^(1)_nn-c^(2),1_1/c^(1),1_1 A_46u^(2)-A̅_78u^(2)_nn),
    
        z^(1)_t_in =     2/15( 3√(5)/2c^(1),0_2 (w^0,W_t_i-w^0_t_i) -1/2A_45 u^(1)_t_i - 1/2 A_57u^(2)_t_i -A_59 u^(2)_t_inn),    i=1,2, 
    
        z^(2)_t_in =     2/15(  3√(5)/2c^(2),0_2 (w^0,W_t_i-w^0_t_i)  - 1/2A_48u^(1)_t_i-1/2A̅_78u^(2)_t_i- c^(2),0_2/c^(1),0_2A_59 u^(2)_t_inn),   i=1,2,
    
        z^(2)_t_it_jn =     2/35 A_59[ 2/15δ_ij(u^(1)_nn+c^(2),0_2/c^(1),0_2u^(2)_nn) - 1/3(u^(1)_t_it_j+c^(2),0_2/c^(1),0_2u^(2)_t_it_j)],    i,j=1,2, 
    
        z^(2)_nnn =     2/175A_59[(u^(1)_t_1t_1+c^(2),0_2/c^(1),0_2u^(2)_t_1t_1) + (u^(1)_t_2t_2+c^(2),0_2/c^(1),0_2u^(2)_t_2t_2) -2(u^(1)_nn+c^(2),0_2/c^(1),0_2u^(2)_nn)].

Combining (<ref>) with (<ref>), we obtain the expressions of the coefficients λ'_ij as 

λ'_ij = 
        -√(5)(c^(1),1_1γ'_i1  +c^(2),1_1 γ'_i2),     if  j = 1

        -A_45γ'_i1 - A_57γ'_i2 + 3/5A_59(3 γ'_i3 - γ'_i4) ,    if  j = 2

        -A_46(γ'_i1 + c^(2),1_1/c^(1),1_1γ'_i2) ,    if  j = 3

        -A_48γ'_i1 - A̅_78 γ'_i2 + c^(2),0_2 A_59/5c^(1),0_2(4 γ'_i3 - 3 γ'_i4),    if  j = 4
    ,  for  i = 1,2,5;


λ'_ij = 
        -3√(5)(c^(1),0_2γ'_i1  +c^(2),0_2 γ'_i2),     if  j = 1

        -(A_45γ'_i1 + A_48γ'_i2) ,    if  j = 2

         -(A_57γ'_i1 + A̅_78γ'_i2)  ,    if  j = 3

        -2A_59(γ'_i1  +c^(2),0_2/c^(1),0_2 γ'_i2),    if  j = 4
    ,  for  i = 3,4;


λ'_ij = 
        -A_59(γ'_63+γ'_64),     if  (i,j) = (6,1)

      1/5A_59(9/2γ'_53+2γ'_63+7γ'_64),     if  (i,j) = (6,2)

          -2A_59γ'_71,     if  (i,j) = (7,1)
    .

In the expressions above, γ'_ij are given as 

γ'_ij = 
       ∑_m=1^∞∑_m'=1^∞c^(i),m_1 c^(1),m'_1 (𝒜^m'_m;n - 𝒜^m'_0;nI^0_m;n/I^0_0;n) ,     if  j = 1

        ∑_m=1^∞∑_m'=1^∞c^(i),m_1 c^(2),m'_1 (𝒜^m'_m;n - 𝒜^m'_0;nI^0_m;n/I^0_0;n) ,    if  j = 2

        3∑_m=1^∞∑_m'=0^∞c^(i),m_1 c^(2),m'_3 (𝒞^m';t_1t_1_m;n - 𝒞^m';t_1t_1_0;nI^0_m;n/I^0_0;n) ,    if  j = 3

        ∑_m=1^∞∑_m'=0^∞c^(i),m_1 c^(2),m'_3 (𝒟^m'_m;n - 𝒟^m'_0;nI^0_m;n/I^0_0;n),    if  j = 4
    ,  for  i = 1,2;


γ'_ij = 
       2∑_m=0^∞∑_m'=0^∞c^(i-2),m_2 c^(1),m'_2 ℬ^m';t_1_m;t_1n  ,     if  j = 1

        2∑_m=0^∞∑_m'=0^∞c^(i-2),m_2 c^(2),m'_2 ℬ^m';t_1_m;t_1n ,    if  j = 2
    ,  for  i = 3,4;


γ'_ij = 
       ∑_m=0^∞∑_m'=1^∞c^(2),m_3 c^(1),m'_1 (𝒜^m'_m;nnn - 𝒜^m'_0;nI^0_m;nnn/I^0_0;n) ,     if  j = 1

        ∑_m=0^∞∑_m'=1^∞c^(2),m_3 c^(2),m'_1 (𝒜^m'_m;nnn - 𝒜^m'_0;nI^0_m;nnn/I^0_0;n) ,    if  j = 2

        3∑_m=0^∞∑_m'=0^∞c^(2),m_3 c^(2),m'_3 (𝒞^m';t_1t_1_m;nnn - 𝒞^m';t_1t_1_0;nI^0_m;nnn/I^0_0;n) ,    if  j = 3

        ∑_m=0^∞∑_m'=0^∞c^(2),m_3 c^(2),m'_3 (𝒟^m'_m;nnn - 𝒟^m'_0;nI^0_m;nnn/I^0_0;n),    if  j = 4
    ,  for  i = 5;


γ'_ij = 
      -1/2γ'_51 ,     if  j = 1

        -1/2γ'_52  ,    if  j = 2

        3∑_m=0^∞∑_m'=0^∞c^(2),m_3 c^(2),m'_3 (𝒞^m';t_1t_1_m;t_1 t_1 n - 𝒞^m';t_1t_1_0;nI^0_m;t_1 t_1 n/I^0_0;n) ,    if  j = 3

         3∑_m=0^∞∑_m'=0^∞c^(2),m_3 c^(2),m'_3 (𝒞^m';t_2t_2_m;t_1 t_1 n - 𝒞^m';t_2t_2_0;nI^0_m;t_1 t_1 n/I^0_0;n) ,    if  j = 4

       -1/2γ'_54,    if  j = 5
    ,  for  i = 6.






 §.§ Expressions of λ_ij










    λ_11 = 3√(5)/2c^(1),1_1 κ_11,  λ_12 = -√(2)/2c^(1),1_1/c^(1),0_2κ_12,  λ_13 = c^(1),1_1 β'_0 κ_13,  λ_14 = c^(1),1_1β'_2 ( κ_14 - c^(2),0_2/c^(1),0_2κ_12),
    λ_21 = √(5)c^(1),0_2 λ'_31 + √(5) c^(2),0_2 λ'_41 ,  λ_22 = -√(2)c^(1),0_2/c^(1),1_1λ'_32 - √(2)c^(2),0_2/c^(1),1_1λ'_42, 
    λ_23 = c^(1),0_2 β'_1 ( λ'_33 - c^(2),1_1/c^(1),1_1λ'_32) + c^(2),0_2 β'_1 ( λ'_43 - c^(2),1_1/c^(1),1_1λ'_42),  λ_24 = c^(1),0_2 β'_3λ'_34 + c^(2),0_2 β'_3λ'_44,
    λ_31 = -√(5/2)λ'_41/β'_2,  λ_32 = λ'_42/c^(1),1_1 β'_2,  λ_33 = -√(2)/2β'_1/β'_2( λ'_43 - c^(2),1_1/c^(1),1_1λ'_42),  λ_34 = -√(2)/2β'_3/β'_2λ'_44,
    λ_41 = -3√(10)/2β'_3 μ_1( κ_21 + c^(2),1_1 μ_2/c^(1),1_1κ_11),  λ_42 = 1/ c^(1),0_2 β'_3 μ_1 ( κ_22 + c^(2),1_1 μ_2/c^(1),1_1κ_12), 
    λ_43 = -√(2)β'_0 /β'_3 μ_1( κ_23 + c^(2),1_1 μ_2/c^(1),1_1κ_13),
        λ_44 =  -√(2)β'_2/β'_3 μ_1[κ_24 - c^(2),0_2 /c^(1),0_2κ_22 + c^(2),1_1 μ_2/c^(1),1_1(κ_14 - c^(2),0_2/c^(1),0_2κ_12) ],  
    λ_45 =  [ 1 + (c^(2),1_1/c^(1),1_1)^2 ]β'_1 μ_2/β'_3 μ_1,  λ_51 = 1/c^(1),0_2λ'_61/β'_3,  λ_52 = 1/c^(1),0_2λ'_62/β'_3, λ_61 = 1/c^(1),0_2λ'_71/β'_3.

Here μ_i and κ_ij are respectively given in (<ref>) and (<ref>). We remark that for Maxwell molecules λ_23 = λ_33=0.



§ TABLES OF COEFFICIENTS IN THE INVERSE-POWER-LAW MODEL

In this section, we list the value of β_i, ℒ^(mn)_l and c^(1),*_* appearing in the moment equations (<ref>)(<ref>) as Table <ref>, and λ_ij in the boundary conditions (<ref>)–(<ref>) as Table <ref> for various choices of parameter η in the inverse-power-law model that we considered in Section <ref>.    










